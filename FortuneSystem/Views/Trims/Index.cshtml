@{
    ViewBag.Title = "TRIMS";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
</div>
<link href="~/Content/base_m.css" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
<link href="~/Content/base_m.css" rel="stylesheet" />
<script>
    var trims, cajas,auditoria;
    $(document).on("input", ".numeric", function () {
        this.value = this.value.replace(/\D/g, '');
    });
    $(document).on("input", ".validacion", function () {
        var c = this.selectionStart,
            r = /[^a-zA-Z0-9áéíóúÁÉÍÓÚñÑ .()!@@/#%-]/,
            v = $(this).val();
        if (r.test(v)) {
            $(this).val(v.replace(r, ''));
            c--;
        }
        this.setSelectionRange(c, c);
    });
    $(document).on("click", "a", function () { $("#loading").css('display', 'none'); });

    $(document).on("input", ".po", function () { $('.po').autocomplete({ source: '@Url.Action("Autocomplete_po")' }); });

    $(document).ready(function () {
        trims = 0; cajas = 0;
        llenar_tabla_ordenes_inicio();
        llenar_items_trim();
        llenar_tabla_trim_recibido_inicio();
        $('.js-example-basic-single').select2();
        $('.js-example-basic-single2').select2();

        $(document).on("input", "#caja_unit_trim_edit", function () { $('#caja_unit_trim_edit').autocomplete({ source: '@Url.Action("Autocomplete_units")' }); });
        $(document).on("input", "#caja_family_trim_edit", function () { $('#caja_family_trim_edit').autocomplete({ source: '@Url.Action("Autocomplete_family")' }); });
        llenar_tabla_trims_inicio();
    });
    $(function () {
        $.datepicker.regional['es'] = {
            closeText: 'Cerrar',
            prevText: '<Ant',
            nextText: 'Sig>',
            currentText: 'Hoy',
            monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
                'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
            monthNamesShort: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun',
                'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
            dayNames: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],
            dayNamesShort: ['Dom', 'Lun', 'Mar', 'Mié', 'Juv', 'Vie', 'Sáb'],
            dayNamesMin: ['Do', 'Lu', 'Ma', 'Mi', 'Ju', 'Vi', 'Sá'],
            weekHeader: 'Sm',
            dateFormat: 'yy-mm-dd',
            firstDay: 1,
            isRTL: false,
            showMonthAfterYear: false,
            yearSuffix: ''
        };
        $.datepicker.setDefaults($.datepicker.regional['es']);
        $('#caja_busqueda_fecha_trim_recibo').datepicker();
        $('#caja_inicio_entrega').datepicker();
        $('#caja_final_entrega').datepicker();
        $('#caja_inicio').datepicker();
        $('#caja_final').datepicker();
        $('#caja_estado_inicio').datepicker();
        $('#caja_estado_final').datepicker();
    });//DATEPICKER
    /**********MP LISTADO**************************************************************************************************************************************************** */
    $(document).on("click", "#ver_recibos_trim", function () {
        $("#load_trim").css('display', 'inline');
        cargar_recibos_trims('');
    });
    function buscar_recibos_fechas(event) {
        //if ($("#caja_inicio").val() != "" && $("#caja_final").val() !== "") {
            cargar_recibos_trims($("#caja_inicio").val() + "*" + $("#caja_final").val());
        /*} else {
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }*/
    }
    function cargar_recibos_trims(busqueda) {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: "/Trims/buscar_informacion_recibos_trims",
            data: "{'busqueda':'" + busqueda + "'}",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                var html = '';//<tr><th>#</th><th>DATE</th><th>MP</th><th>ORDER</th><th>PO</th><th>Items</th><th>TOTAL</th></tr>
                var pedido = '';
                $.each(result, function (key, item) {
                    html += '<tr>';
                    html += '<td style="width:10%;">' + item.id_recibo + '</td>';
                    html += '<td style="width:15%;">' + item.fecha + '</td>';
                    html += '<td style="width:10%;">' + item.mill_po + '</td>';
                    $.each(item.lista_recibos_item, function (key, i) {
                        pedido = i.item.po;
                    });
                    html += '<td style="width:10%;">' + pedido + '</td>';
                    html += '<td style="width:10%;">' + item.po_referencia + '</td>';
                    html += '<td style="width:30%;">';
                    $.each(item.lista_recibos_item, function (key, i) {
                        html += '<p>' + i.item.descripcion+'</p>';
                    });
                    html += '</td>';
                    html += '<td style="width:15%;">';
                    $.each(item.lista_recibos_item, function (key, i) {
                        html += '<p>' + i.total + '</p>';
                    });
                    html += '</td>';
                    html += '</tr>';
                });
                $(".rows_tabla_recibos_trim").html(html);
                $("#load_trim").css('display', 'none');
            },
            error: function (errormessage) { alert(errormessage.responseText); }
        });
    }

    function buscar_recibos_trims(event) {
        if (event.keyCode == 13) {
            llenar_tabla_recibos_filtrados();
            //alert("dfdfds");
        }
    }
    function llenar_tabla_recibos_filtrados() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: "/Trims/buscar_recibos_filtro_trims",
            data: "{'busqueda':'" + $('#caja_busqueda_recibo_trim').val() + "'}",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                var html = '';//<tr><th>#</th><th>DATE</th><th>MP</th><th>ORDER</th><th>PO</th><th>Items</th><th>TOTAL</th></tr>
                var pedido = '';
                $.each(result, function (key, item) {
                    html += '<tr>';
                    html += '<td style="width:10%;">' + item.id_recibo + '</td>';
                    html += '<td style="width:15%;">' + item.fecha + '</td>';
                    html += '<td style="width:10%;">' + item.mill_po + '</td>';
                    $.each(item.lista_recibos_item, function (key, i) {
                        pedido = i.item.po;
                    });
                    html += '<td style="width:10%;">' + pedido + '</td>';
                    html += '<td style="width:10%;">' + item.po_referencia + '</td>';
                    html += '<td style="width:30%;">';
                    $.each(item.lista_recibos_item, function (key, i) {
                        html += '<p>' + i.item.descripcion + '</p>';
                    });
                    html += '</td>';
                    html += '<td style="width:15%;">';
                    $.each(item.lista_recibos_item, function (key, i) {
                        html += '<p>' + i.total + '</p>';
                    });
                    html += '</td>';
                    html += '</tr>';
                });
                $(".rows_tabla_recibos_trim").html(html);
                $("#load_trim").css('display', 'none');
            },
            error: function (errormessage) { alert(errormessage.responseText); }
        });
    }
    /**********MP LISTADO**************************************************************************************************************************************************** */
    /*****REVISIONES********************************************************************************************************************************************************* */
    $(document).on("click", "#ver_revisiones", function () {
        $("#load_trim").css('display', 'inline');
        llenar_po();
    });
    function llenar_po() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = ''; //'<label class="">PO&nbsp;</label> <select class="form-control js-example-basic-single" id="caja_pedido" >';
                html += '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                //html += '</select>';
                $(".pedidos").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    /**********REVISIONES*****************************************************************************************************************************************************/
    /*****REQUESTS************************************************************************************************************************************************************/
    $(document).on("click", "#ver_request", function () {
        $("#load_trim").css('display', 'inline');
        $(".pedidos_request").html("");
        llenar_po_request();
        $("#div_estilos_request").css('visibility', 'visible');
        $("#div_estilos_request").css('display', 'none');
        $("#div_tallas_request").css('visibility', 'visible');
        $("#boton_guardar_request").css('display', 'none');

    });
    function llenar_po_request() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = ''; //'<label class="">PO&nbsp;</label> <select class="form-control js-example-basic-single" id="caja_pedido" >';
                html += '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $(".pedidos_request").append(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    var estilos_trims_anteriores;
    $(document).on("change", "#caja_pedido_request", function () {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_estilos',
            contentType: 'application/json',
            data: "{'pedido':'" + $("#caja_pedido_request").val()+"'}",
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                var result = jsonData.Data.estilos;
                var doblado = jsonData.Data.fold_size;
                estilos_trims_anteriores = jsonData.Data.trims_anteriores;
                var empaque = jsonData.Data.empaque;
                if (empaque == 1) { $("#caja_instruccion_empaque_cb").prop('checked', true); } else { $("#caja_instruccion_empaque_cb").prop('checked', false); }
                var html = '';
                html += '<label for="caja_pedido_request">Style</label><select class="form-control  estilos_request " style="" id="caja_estilo_request" >';//'<label class="">PO&nbsp;</label> <select class="form-control js-example-basic-single" id="caja_pedido" >';
                html += '<option  value="0">Select</option>';
                html += '<option value="0';
                $.each(result, function (key, item) {
                    html += "*"+item.id_po_summary;
                });
                html += '">All</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_po_summary + '">' + item.estilo + ' ' + item.descripcion+ '</option>';
                });
                html += '</select>';
                $("#div_estilos_request").css('display', 'inline');
                $("#div_estilos_request").html(html);
                $("#caja_fold_size_trim").val(doblado);
                $("#load_trim").css('display', 'none');
                agregar_trims_anteriores();
            }
        });
    });
    var request_anteriores;
    function agregar_trims_anteriores() {
        $("#load_trim").css('display', 'inline');
        request_anteriores = '';
        $.each(estilos_trims_anteriores, function (key, item) {
            $.each(item.lista_requests, function (key, i) {
                request_anteriores += '*' + i.id_request;
                var html = '';
                if (i.tipo_item != 'BOXES') {
                    trims++;
                    html = '<tr id="' + i.id_item + '"><td>' + i.estilo + ' - ' + i.talla + ' </td><td>' + i.item + '</td>';
                    $("#div_tabla_trim_seleccionado").css('display', 'inline');
                    html += '<td><input ondrop="return false;" onpaste="return false;" maxlength="6" class="numeric form-control check_trims" id="qty_' + trims + '" value="'+i.cantidad+'" onkeyup="change_total_trim(' + trims + ')"  /></td>';  //boxes
                    html += '<td><input ondrop="return false;" onpaste="return false;" maxlength="6" class="numeric form-control check_trims " id="blank_' + trims + '" value="'+i.blanks+'" onkeyup="change_total_trim(' + trims + ')"  /></td>';  //boxes
                    html += '<td><input ondrop="return false;" onpaste="return false;" maxlength="6" class="numeric form-control check_trims " id="total_' + trims + '" value="' + i.total + '" /></td>';  //boxes
                    html += '<td><button type="button" class="btn btn-light deleteRowTrim"><b>-</b></button></td>';
                    html += '<td style="visibility:hidden;">' + i.id_summary + '</td><td style="visibility:hidden;" id="item_' + trims + '" >' + i.id_item + '</td>' +
                        '<td style="visibility:hidden;" id="totalTalla_' + trims + '" >' + i.total + '</td><td style="visibility:hidden;" id="' + trims + '" >' + i.id_talla + '</td>';
                    html += '<td style="visibility:hidden;">' + i.id_request + '</td></tr>';
                    $("#boton_guardar_request").css('display', 'inline');
                    $(".body_tabla_trim_seleccionado").append(html);
                } else {
                    cajas++;
                    html = '<tr id="' + trims + '"><td>' + i.estilo + ' - ' + i.talla+ ' </td><td>' + i.item + '</td>';
                    $("#div_tabla_cajas_seleccionadas").css('display', 'inline');
                    html += '<td><input ondrop="return false;" onpaste="return false;" maxlength="6" class="numeric form-control check_boxes " id="" value="' + i.total + '" /></td>';  //boxes
                    html += '<td><button type="button" class="btn btn-light deleteRowCaja"><b>-</b></button></td>';
                    html += '<td style="visibility:hidden;">' + i.id_summary + '</td><td style="visibility:hidden;">' + i.id_item + '</td>';
                    html += '<td style="visibility:hidden;">' + i.id_request + '</td></tr>';
                    $("#boton_guardar_request").css('display', 'inline');
                    $(".body_tabla_cajas_seleccionadas").append(html);
                }
            });
        });
       // if (cajas > 0 || trims > 0) { $("#boton_guardar_request").css('display', 'inline'); }
        $("#load_trim").css('display', 'none');
    }
    $(document).on("change", "#caja_estilo_request", function () {
        llenar_tallas_estilo();
        //llenar_items_trim();
        $("#div_item_request").css('visibility', 'visible');
        $("#div_button_add").css('visibility', 'visible');

        //$("#boton_agregar_item_tabla").css('visibility', 'visible');

    });
    function llenar_tallas_estilo() {
        $.ajax({
            url: '/Trims/buscar_tallas_estilo',
            contentType: 'application/json',
            data: "{'estilo':'" + $("#caja_estilo_request").val() + "'}",
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                html += '<label for="caja_talla_request">Size</label><select class="form-control tallas_request" style="" id="caja_talla_request" >';//'<label class="">PO&nbsp;</label> <select class="form-control js-example-basic-single" id="caja_pedido" >';
                html += '<option  value="0">All</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_talla + '">' + item.talla + '</option>';
                });
                html += '</select>';
                $("#div_tallas_request").css('display', 'inline');
                $("#div_tallas_request").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function llenar_items_trim() {
        $.ajax({
            url: '/Trims/buscar_inventario_items_trim',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
               // html += '<label for="caja_item_request">Item</label><select class="form-control js-example-basic-single2 items_request" style="" id="caja_item_request" >';
                html += '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_item + '">' + item.descripcion + '</option>';
                });
                //html += '</select>';
                $(".items_request").append(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("click", ".cerrar_material_request", function () {
        cerrar_modal_trim_request();
    });
    function cerrar_modal_trim_request() {
        trims = 0; cajas = 0;
        $("#div_tabla_cajas_seleccionadas").css('display', 'none');
        $("#div_tabla_trim_seleccionado").css('display', 'none');
        $("#div_estilos_request").css('display', 'none');
        $("#div_tallas_request").css('display', 'none');
        $("#div_item_request").css('visibility', 'hidden');
        $(".body_tabla_trim_seleccionado").html("");
        $(".body_tabla_cajas_seleccionadas").html("");
        $("#caja_pedido_request").val('0');
        $("#myselect caja_pedido_request[value=0]").attr('selected', 'selected');
    }
    function agregar_item_tablas() {
        var id_item = $("#caja_item_request").val(), item = $("#caja_item_request").find(":selected").text();
        var id_estilo = $("#caja_estilo_request").val(), estilo = $("#caja_estilo_request").find(":selected").text();
        var talla = $("#caja_talla_request").val(), talla_tabla = $("#caja_talla_request").find(":selected").text();
        $.ajax({
            url: '/Trims/buscar_total_estilo',
            data: "{'summary':'" + $("#caja_estilo_request").val() + "','talla':'" + $("#caja_talla_request").val() + "','item':'" + $("#caja_item_request").val() + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                var categoria = jsonData.Data.categoria, total = jsonData.Data.total, cajas_total = jsonData.Data.cajas;
                var html = '';
                var summarys = id_estilo.split('*');
                for (var i = 0; i < summarys.length; i++) {
                    if (summarys[i] != "0") {
                        if (categoria != 'BOXES') {
                            trims++;
                            html = '<tr id="' + trims + '"><td>' + estilo + ' ' + talla_tabla + ' </td><td>' + item + '</td>';
                            $("#div_tabla_trim_seleccionado").css('display', 'inline');
                            html += '<td><input ondrop="return false;" onpaste="return false;" maxlength="6" class="numeric form-control check_trims" id="qty_' + trims + '" value="1" onkeyup="change_total_trim(' + trims + ')"  /></td>';  //boxes
                            html += '<td><input ondrop="return false;" onpaste="return false;" maxlength="6" class="numeric form-control check_trims " id="blank_' + trims + '" value="1" onkeyup="change_total_trim(' + trims + ')"  /></td>';  //boxes
                            html += '<td><input ondrop="return false;" onpaste="return false;" maxlength="6" class="numeric form-control check_trims " id="total_' + trims + '" value="' + total + '" /></td>';  //boxes
                            html += '<td><button type="button" class="btn btn-light deleteRowTrim"><b>-</b></button></td>';
                            html += '<td style="visibility:hidden;">' + summarys[i] + '</td><td style="visibility:hidden;" id="item_' + trims + '" >' + id_item + '</td>' +
                                '<td style="visibility:hidden;" id="totalTalla_' + trims + '" >' + total + '</td><td style="visibility:hidden;" id="' + trims + '" >' + talla + '</td>';
                            html += '<td style="visibility:hidden;">0</td></tr>';
                            $(".body_tabla_trim_seleccionado").append(html);
                        } else {
                            cajas++;
                            html = '<tr id="' + trims + '"><td>' + estilo + ' ' + talla_tabla + ' </td><td>' + item + '</td>';
                            $("#div_tabla_cajas_seleccionadas").css('display', 'inline');
                            html += '<td><input ondrop="return false;" onpaste="return false;" maxlength="6" class="numeric form-control check_boxes " id="" value="' + cajas_total + '" /></td>';  //boxes
                            html += '<td><button type="button" class="btn btn-light deleteRowCaja"><b>-</b></button></td>';
                            html += '<td style="visibility:hidden;">' + summarys[i] + '</td><td style="visibility:hidden;">' + id_item + '</td>';
                            html += '<td style="visibility:hidden;">0</td></tr>';
                            $(".body_tabla_cajas_seleccionadas").append(html);
                        }
                    }
                }
                $("#boton_guardar_request").css('display', 'inline');
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function change_total_trim(row) {
        var qty = 0, blanks = 0, total = 0;
        qty = $('#qty_' + row).val();
        blanks = $('#blank_' + row).val();
        totalTalla = parseFloat($('#totalTalla_' + row).html());
        total = qty * (totalTalla / blanks);
        $('#total_' + row).val(total);
    }
    $(document).on("click", ".deleteRowTrim", function () {
        $(this).closest("tr").remove();
        trims--;
        if (trims <= 0) {
            $("#div_tabla_trim_seleccionado").css('display', 'none');
        } else {
            $("#div_tabla_trim_seleccionado").css('display', 'inline');
        }
        if (trims == 0 && cajas == 0) {
            $("#boton_guardar_request").css('display', 'none');
        }
    });
    $(document).on("click", ".deleteRowCaja", function () {
        $(this).closest("tr").remove();
        cajas--;
        if (cajas <= 0) {
            $("#div_tabla_cajas_seleccionadas").css('display', 'none');
        } else {
            $("#div_tabla_cajas_seleccionadas").css('display', 'inline');
        }
        if (trims == 0 && cajas == 0) {
            $("#boton_guardar_request").css('display', 'none');
        }
    });
    var estilo, item, total, talla,cantidad,blank,request,instruccion,fold_size_trim;
    function guardar_request(event) {
        if (trims >= 1 || cajas >= 1) {
            $("#load_trim").css('display', 'inline');
            var error = 0;
            if (trims >= 1) {
                $(".check_trims").each(function () {
                    if ($(this).val() == '0' || $(this).val() == '' || $(this).val() == 0) {
                        $(this).css('border', '2px solid #e03f3f');
                        error++;
                    } else {
                        $(this).css('border', '1px solid #cccccc');
                    }
                });
            }
            if (cajas >= 1) {
                $(".check_boxes").each(function () {
                    if ($(this).val() == '0' || $(this).val() == '' || $(this).val() == 0) {
                        $(this).css('border', '2px solid #e03f3f');
                        error++;
                    } else {
                        $(this).css('border', '1px solid #cccccc');
                    }
                });
            }
            if (error == 0) {
                estilo = ''; item = ''; total = ''; talla = ''; cantidad = ''; black = ''; request = ''; fold_size_trim = '';
                if ($("#caja_fold_size_trim").val() == '') { fold_size_trim = "n/a"; } else { fold_size_trim = $("#caja_fold_size_trim").val(); }
                if ($('#caja_instruccion_empaque_cb').is(":checked")) { instruccion = 1; } else { instruccion = 0; }
                if (trims >= 1) {
                    $('#tabla_trim_seleccionado tbody tr').each(function () {
                        total += "*" + $(this).find('td:eq(4) input').val();
                        cantidad += "*" + $(this).find('td:eq(2) input').val();
                        blank += "*" + $(this).find('td:eq(3) input').val();
                        estilo += "*" + $(this).find('td:eq(6) ').html();
                        item += "*" + $(this).find('td:eq(7) ').html();
                        talla += "*" + $(this).find('td:eq(9)').html();
                        request += "*" + $(this).find('td:eq(10)').html();
                    });
                }
                if (cajas >= 1) {
                    $('#tabla_cajas_seleccionadas tbody tr').each(function () {
                        total += "*" + $(this).find('td:eq(2) input').val();
                        estilo += "*" + $(this).find('td:eq(4) ').html();
                        item += "*" + $(this).find('td:eq(5) ').html();
                        talla += "*0"; cantidad += "*0"; blank += "*0";
                        request += "*" + $(this).find('td:eq(6)').html();

                    });
                }
                enviar_request();
            } else {
                $("#load_trim").css('display', 'none');
                event.preventDefault();
                alertify.alert('Error!', 'Check empty fields, please');
                return false;
            }
        }
    }
    function enviar_request() {
        $.ajax({
            url: '/Trims/enviar_datos_request',
            data: "{'total':'" + total + "','estilo':'" + estilo + "','item':'" + item + "','talla':'" + talla + "','cantidad':'" + cantidad + "','blank':'" + blank + "','request':'" + request + "','request_original':'" + request_anteriores + "','instruccion':'" + instruccion + "','fold_size':'" + fold_size_trim+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                trims = 0; cajas = 0;
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
                $(".body_tabla_trim_seleccionado").html('');
                $(".body_tabla_cajas_seleccionadas").html('');
                $("#div_tabla_trim_seleccionado").css('display', 'none');
                $("#div_tabla_cajas_seleccionadas").css('display', 'none');
                $("#boton_guardar_request").css('display', 'none');
                $("#modal_request").modal("hide");
                $("#caja_fold_size_trim").val('');
                $("#load_trim").css('display', 'none');
                var html = '';
                $.each(result, function (key, i) {
                    html += '<tr>';
                    html += '<td style="width:40%;">' + i.item + '</td>';
                    html += '<td style="width:20%;">' + i.total + '</td>';
                    html += '<td style="width:20%;">' + i.cantidad + '</td>';
                    var diferencia = (i.cantidad - i.total);
                    if (diferencia < 0) {
                        html += '<td style="width:20%;">0</td>';
                    } else {
                        html += '<td style="width:20%;">' + diferencia + '</td>'; 
                    }                                     
                    html += '</tr>';
                    $("#po_orden_existencia").html("Order "+i.pedido);
                });
                $(".body_tabla_diferencia_pedido_existencia").html(html);
                $("#modal_lista_existencia").modal("show");
            }
        });
    }
    /**********REQUESTS****************************************************************************************************************************************************** */
    /******************AUDIT************************************************************************************************************************************************* */
    $(document).on("click", "#ver_auditoria", function () {
        $("#load_trim").css('display', 'inline');
        llenar_trims_recibidos();
    });
    function llenar_trims_recibidos() {
        auditoria = 0;
        $.ajax({
            url: '/Trims/buscar_lista_trims_recibidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = ''; //<th>Date</th><th>PO</th><th>Style</th><th>Trim</th><th>Total</th><th></th>

                    $.each(result, function (key, i) {
                        html += '<tr>';
                        html += '<td>' + i.pedido + '</td>';
                        html += '<td>' + i.estilo + '</td>';
                        html += '<td>' + i.descripcion + '</td>';
                        html += '<td>' + i.total + '</td>';
                        html += '<td style="visibility:hidden;">' + i.id_inventario + '</td>';
                        html += '</tr>';
                    });

                $(".body_tabla_items_recibidos").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("dblclick", "#tabla_items_recibidos tr", function () {
        var row = this.rowIndex;
        if (row != 0) {
            auditoria++;
            var num_item = $('#tabla_items_recibidos tr:eq(' + row + ') td:eq(4)').html();
            var item = $('#tabla_items_recibidos tr:eq(' + row + ') td:eq(2)').html();
            var total = $('#tabla_items_recibidos tr:eq(' + row + ') td:eq(3)').html();
            var html = '<tr><td>' + num_item + '</td><td>' + item + '</td><td>' + total + '</td>';
            html += '<td><input ondrop="return false;" onpaste="return false;" maxlength="6" class="numeric form-control check_audit " value="' + total + '" /></td>';
            html += '<td><button type="button" class="btn btn-light deleteRowAudit"><b>-</b></button></td></tr>';
            $(".body_tabla_items_recibidos_modificar").append(html);
            $("#div_edicion_audit").css('visibility','visible');
        }
    });
    $(document).on("click", ".deleteRowAudit", function () {
        $(this).closest("tr").remove();
        auditoria--;
        if (auditoria <= 0) {
            $("#div_edicion_audit").css('visibility', 'hidden');
        } else {
            $("#div_edicion_audit").css('visibility', 'visible');
        }
    });
    var salidas, cant_original, cant_nueva;
    function enviar_correcciones(event) {
        var error = 0;
        $(".check_audit").each(function () {
            if ($(this).val() == '0' || $(this).val() == '' || $(this).val() == 0) {
                $(this).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $(this).css('border', '1px solid #cccccc');
            }
        });
        if (error == 0) {
            salidas = ''; cant_original = ''; cant_nueva = '';
            $('#tabla_items_recibidos_modificar tbody tr').each(function () {
                cant_nueva += "*" + $(this).find('td:eq(3) input').val();
                salidas += "*" + $(this).find('td:eq(0) ').html();
                cant_original += "*" + $(this).find('td:eq(2) ').html();
             });
            enviar_auditoria();
        } else {
            $("#load_trim").css('display', 'none');
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function enviar_auditoria() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/enviar_datos_auditoria',
            data: "{'salidas':'" + salidas + "','originales':'" + cant_original + "','nuevas':'" + cant_nueva + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                auditoria = 0;
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
                $(".body_tabla_items_recibidos_modificar").html('');
                $("#modal_auditoria").modal("hide");
                $("#modal_comparacion").modal("show");
                $("#load_trim").css('display', 'none');
                var html = '';
                $.each(result, function (key, i) {
                    if (i.item != null) {
                        html += '<tr>';
                        if (i.cantidad >= i.total) {
                            html += '<tr style="color:#3c763d;">';
                        } else {
                            html += '<tr style="color:#941c1c;">';
                        }
                        html += '<td>' + i.pedido + '</td>';
                        html += '<td>' + i.estilo + '</td>';
                        html += '<td>' + i.item + '</td>';
                        html += '<td>' + i.tipo_item + '</td>';
                        html += '<td>' + i.total + '</td>';
                        html += '<td>' + i.fecha + '</td>';
                        html += '<td>' + i.cantidad + '</td>';
                        if (i.cantidad >= i.total) {
                            html += '<td>Completed</td>';
                        } else {
                            html += '<td>Incomplete</td>';
                        }
                        html += '<td style="visibility:hidden;">' + i.id_inventario + '</td>';
                        html += '</tr>';
                    }
                });
                $(".body_tabla_comparacion_auditado").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }

    /******************AUDIT***************************************************************************************************************************************************/
    /*******************IMPRIMIR TRIM CARD************************************************************************************************************************************/
    function revisar_po(event) {
        if (event.keyCode == 13) {
            
            $.ajax({
                url: '/Trims/po_session',
                data: "{'po':'" + $("#caja_po_trim_card").val() + "'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (result) {

                }
            });
            imprimir_trim_card();
        }
    }
    function imprimir_trim_card() {
        var h = screen.height - 100;
        var w = screen.width - 30;
        window.open('/Trims/trim_card', '_blank', 'toolbar=0,location=0,menubar=0,width=' + w + ',height=' + h + ', fullscreen=yes');
    }
    /*******************IMPRIMIR TRIM CARD************************************************************************************************************************************/
    /*******************EDITAR ITEM******************************************************************************************************************************************/
    $(document).ready(function () {
        $('.js-example-basic-single').select2();
    });

    $(document).on("click", ".btn_editar_item", function () {
        $("#load_trim").css('display', 'inline');
        llenar_items_edicion();
    });
    function llenar_items_edicion() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_items_trims',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<option value="0">Select trim</option>';
                $.each(result, function (key, item) {
                    html += '<option value="' + item.id_item + '">' + item.descripcion + '</option>';
                });
                $(".descripciones_edit").append(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).ready(function () {
        $('#caja_item_select').on('change', function () {
            buscar_datos_edicion_trim();
        });
    });
    function buscar_datos_edicion_trim() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_informacion_trim',
            contentType: 'application/json',
            data: "{'id':'" + $('#caja_item_select').val()+"'}",
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                var trim = jsonData.Data.trim;
                var html = '';
                $.each(trim, function (key, item) {
                    $("#edicion_trim_catalogo").css('display','inline');
                    $("#id_trim_edicion").val(item.id_item);
                    $("#caja_trim_item_edit").val(item.item);
                    $("#caja_minimo_trim_edit").val(item.minimo);
                    $("#caja_descripcion_edit").val(item.descripcion);
                    $("#caja_family_trim_edit").val(item.family);
                    $("#caja_unit_trim_edit").val(item.unit);
                });
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function guardar_edicion_trim() {
        var error = 0;
        $(".edit_trim").each(function () {
            var id = $(this).attr('id');
            if ($(this).val() == '') {
                $("#" + id).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $("#" + id).css('border', '1px solid #cccccc');
            }
        });
        if (error == 0) {
            modificar_item();
        } else {
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function modificar_item() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/editar_trim_catalogo',
            data: "{'id':'" + $("#id_trim_edicion").val() + "','item':'" + $("#caja_trim_item_edit").val() + "','minimo':'" + $("#caja_minimo_trim_edit").val() + "','descripcion':'" + $("#caja_descripcion_edit").val() + "','family':'" + $("#caja_family_trim_edit").val() + "','unidad':'" + $("#caja_unit_trim_edit").val() +"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                $('#caja_item_select').val(0);
                $("#edicion_trim_catalogo").css('display', 'none');
                $("#load_trim").css('display', 'none');
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }

    /*******************EDITAR ITEM************************************************************************************************************************************/
    /*******************TABLA**INICIO**********************************************************************************************************************************/
    function llenar_tabla_trims_inicio() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_trims_tabla_inicio',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    html += '<tr>';
                    html += '<td>' + item.item + '</td>';
                    html += '<td>' + item.descripcion + '</td>';
                    html += '<td>' + item.minimo + '</td>';
                    html += '<td>' + item.total + '</td>';
                    html += '</tr>';
                });
                $(".body_tabla_trims_inicio").append(html);
            }
        });
    }
    //OTRA TABLA AL INICIO
    function llenar_tabla_ordenes_inicio() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_ordenes_tabla_inicio',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    var total_orden = 0, total_recibido = 0, total_final = 0;
                    $.each(item.lista_estilos, function (key, e) {
                        $.each(e.lista_requests, function (key, r) {
                            total_orden += r.total;
                            total_recibido += (r.total - r.restante);
                        });
                    });
                    total_final = ((total_recibido * 100) / total_orden).toFixed(2);;
                    if (total_recibido >= total_orden) {
                        html += '<tr style="color:#3c763d;">';
                    } else {
                        html += '<tr style="color:#941c1c;">';
                    }
                    html += '<td style="width:20%;">' + item.id_pedido + '</td>';
                    html += '<td style="width:20%;">' + item.pedido + '</td>';
                    html += '<td style="width:20%;">' + total_orden + '</td>';
                    html += '<td style="width:20%;">' + total_recibido + '</td>';
                    html += '<td style="width:20%;">' + total_final + '% </td>';
                    html += '</tr>';
                });
                $(".body_tabla_ordenes_inicio").html(html);
            }
        });
    }
    function llenar_tabla_trim_recibido_inicio() {
        $("#load_trim").css('display', 'inline');
        var busqueda, fecha;
        if ($("#caja_busqueda_trim_recibido").val() == "") { busqueda = '0'; } else { busqueda = $("#caja_busqueda_trim_recibido").val();}
        if ($("#caja_busqueda_fecha_trim_recibo").val() == "") { fecha = '0'; } else { fecha = $("#caja_busqueda_fecha_trim_recibo").val();}
        $.ajax({
            url: '/Trims/buscar_trims_recibidos_tabla_inicio',
            contentType: 'application/json',
            data: "{'busqueda':'" +busqueda + "','fecha':'" + fecha+"'}",
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                var result = jsonData.Data.tabla;
                var mps = jsonData.Data.mps;
                var html = '';
                $.each(result, function (key, item) {
                    if (item.auditoria==1) {
                        html += '<tr style="color:#3c763d;">';
                    } else {
                        html += '<tr style="color:#941c1c;">';
                    }
                    html += '<td>' + item.id_inventario + '</td>';
                    html += '<td>' + item.po + '</td>';
                    html += '<td>' + item.estilo + '</td>';
                    html += '<td>' + item.descripcion + '</td>';
                    html += '<td>' + item.fecha + '</td>';
                    html += '<td>' + item.total + '</td>';
                    if (item.auditoria == 1) {
                        html += '<td><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></td>';
                    } else {
                        html += '<td><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></td>';
                    }
                    html += '</tr>';
                });
                $(".body_tabla_trim_recibido").html(html);
                html = 'MP Numbers today: ';
                $.each(mps, function (key, item) {
                    html += ' '+item.mp_number +' ';
                });
                $("#mp_numbers_label").html(html);
            }
        });
        $("#load_trim").css('display', 'none');
    }
    function busqueda_estado_pedido() {
        if (event.keyCode == 13) {
            $("#load_trim").css('display', 'inline');
            var busqueda;
            if ($("#caja_busqueda_estado_pedido").val() == "") { busqueda = "0"; } else { busqueda = $("#caja_busqueda_estado_pedido").val(); }
            $.ajax({
                url: '/Trims/buscar_especifico_ordenes_tabla_inicio',
                contentType: 'application/json',
                data: "{'busqueda':'" + busqueda + "'}",
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    var html = '';
                    $.each(result, function (key, item) {
                        var total_orden = 0, total_recibido = 0, total_final = 0;
                        $.each(item.lista_estilos, function (key, e) {
                            $.each(e.lista_requests, function (key, r) {
                                total_orden += r.total;
                                total_recibido += (r.total - r.restante);
                            });
                        });
                        total_final = ((total_recibido * 100) / total_orden).toFixed(2);;
                        if (total_recibido >= total_orden) {
                            html += '<tr style="color:#3c763d;">';
                        } else {
                            html += '<tr style="color:#941c1c;">';
                        }
                        html += '<td style="width:20%;">' + item.id_pedido + '</td>';
                        html += '<td style="width:20%;">' + item.pedido + '</td>';
                        html += '<td style="width:20%;">' + total_orden + '</td>';
                        html += '<td style="width:20%;">' + total_recibido + '</td>';
                        html += '<td style="width:20%;">' + total_final + '% </td>';
                        //html += '<td style="visibility:hidden; width:.5px;" >' + item.id_pedido + '</td>';
                        html += '</tr>';
                    });
                    $(".body_tabla_ordenes_inicio").html(html);
                    $("#load_trim").css('display', 'none');
                }
            });
        }
    }
    $(document).on("dblclick", "#tabla_trim_recibido tr", function () {
        //alert(this.rowIndex);
        var row = this.rowIndex;
        if (row != 0) {
            //agregar_row_otros($('#tabla_estilos_otros tr:eq(' + row + ') td:eq(0)').html() + "&" + $('#tabla_estilos_otros tr:eq(' + row + ') td:eq(1)').html() + "-" + $('#tabla_estilos_otros tr:eq(' + row + ') td:eq(2)').html());
            $.ajax({
                url: '/Trims/obtener_informacion_recibo',
                contentType: 'application/json',
                data: "{'inventario':'" + $('#tabla_trim_recibido tr:eq(' + row + ') td:eq(0)').html() + "','total':'" + $('#tabla_trim_recibido tr:eq(' + row + ') td:eq(5)').html()+"'}",
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    var html = '';
                    $.each(result, function (key, item) {
                        var inventario;
                        var html = '' +
                            '<tr><td>' + result.id_recibo + '</td> ' +
                            '<td>' + result.mp_number + '</td> ' +
                            '<td>' + result.fecha + '</td> ' +
                            '<td>' + result.items + '</td> ' +
                            '<td>' + result.total + '</td> ' +
                            '<td>' + result.usuario + '</td> ' +
                            '<td>' + result.sucursal + '</td> ' +
                            '<td>' + result.mill_po + '</td> ' +
                            '<td>' + result.po_referencia + '</td> </tr>';
                        $(".recibo_individual_trim").html(html);

                        var recibos_items = result.lista_recibos_item;
                        html = '';
                        $.each(recibos_items, function (key, ri) {
                            inventario = ri.item;
                            html += '<tr><td>' + inventario.po + '</td> ' +
                                '<td>' + inventario.categoria_inventario + '</td> ' +
                                '<td>' + inventario.descripcion + '</td> ' +
                                '<td>' + ri.total + '</td> </tr>';
                        });
                        $(".recibo_items_individual_trim").html(html);
                        $("#modal_trim_receive_details").modal("show");
                        //$("#detalles_recibo").css('display', 'inline');
                    });
                    //$(".body_tabla_trim_recibido").html(html);
                }
            });
        }

    });
    /*******************TABLA**INICIO**********************************************************************************************************************************/
    /*******************ENTREGA**DE**TRIMS*****************************************************************************************************************************/
    //btn_entregar_material
    $(document).on("click", ".btn_entregar_material", function () {
        //$("#load_trim").css('display', 'inline');
        llenar_po_entrega();
    });
    function llenar_po_entrega() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = ''; //'<label class="">PO&nbsp;</label> <select class="form-control js-example-basic-single" id="caja_pedido" >';
                html += '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $(".pedidos_entrega").append(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    var estilos_entrega;
    $(document).on("change", "#caja_pedido_entrega", function () {
        $.ajax({
            url: '/Trims/buscar_trims_pedido',
            contentType: 'application/json',
            data: "{'pedido':'" + $("#caja_pedido_entrega").val() + "'}",
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                estilos_entrega = jsonData.Data.trims_anteriores;
                var html = '';
                agregar_trims_entrega();
            }
        });
    });
    var trims_entrega_seleccionados;
    function agregar_trims_entrega() {
        $("#load_trim").css('display', 'inline');
        var html = '';
        $.each(estilos_entrega, function (key, item) {
            $.each(item.lista_requests, function (key, i) {
                if (i.entregado < i.total){
                    html += '<tr>';
                    html += '<td>' + i.id_request + '</td>';
                    html += '<td>' + item.estilo + '</td>';
                    html += '<td>' + i.item + '</td>';
                    html += '<td>' + (i.total-i.entregado) + '</td>';
                    html += '<td><input  style="width:8em;" type="text" class=" form-control numeric " ondrop="return false;" onpaste="return false;" value="' + (i.total-i.entregado) + '" maxlength="10" id="caja_sm"></td>';
                    html += '<td style="visibility:hidden; width:1em;"><input type="checkbox"  class="custom-control-input" id="cbrequest_' + i.id_request + '"></td>';
                    html += '</tr>';
                }
            });
        });
        trims_entrega_seleccionados = 0;
        $(".rows_tabla_trims_entrega").html(html);
        $("#load_trim").css('display', 'none');
    }
    $(document).on("click", "#tabla_trims_entrega tr", function () {
        var row = this.rowIndex;
        var chekbox = $('#tabla_trims_entrega tr:eq(' + row + ')  td:nth-child(1)').html();
        if (this.style.background == "" || this.style.background == "white") {
            $("#cbrequest_" + chekbox).prop('checked', true);
            $(this).css('background', '#46a772');
            $(this).css('color', 'white');
            trims_entrega_seleccionados++;
        } else {
            $("#cbrequest_" + chekbox).prop('checked', false);
            $(this).css('background', 'white');
            $(this).css('color', 'black');
            trims_entrega_seleccionados--;
        }
    });
    var cantidad_e, request_e, nombre_entrega_e, nombre_recibe_e,original_e;
    function guardar_entrega(event) {
        var error = 0, error_cantidades = 0;
        cantidad_e = ''; request_e = ''; nombre_entrega_e = '', nombre_recibe_e = ''; original_e = '';
        $(".entrega_item").each(function () {
            var id = $(this).attr('id');
            if ($(this).val() == '' ) {
                $("#" + id).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $("#" + id).css('border', '1px solid #cccccc');
            }
        });
        if (trims_entrega_seleccionados == 0) { error++; }
        $("#load_trim").css('display', 'inline');
        $('#tabla_trims_entrega tbody tr').each(function () {
            if ($(this).find('td:eq(5) input').is(":checked")) {
                if (parseFloat($(this).find('td:eq(3) ').html()) < parseFloat($(this).find('td:eq(4) input').val())) { error_cantidades++; }
                if (parseFloat($(this).find('td:eq(4) input').val())==0) { error_cantidades++; }
                if ($(this).find('td:eq(4) input').val()=='') { error_cantidades++; }
                request_e += "*" + $(this).find('td:eq(0) ').html();
                original_e += "*" + $(this).find('td:eq(3) ').html();
                cantidad_e += "*" + $(this).find('td:eq(4) input').val();
            }
        });
        nombre_entrega_e = $("#caja_nombre_entrega").val();
        nombre_recibe_e = $("#caja_nombre_recibe").val();
        if (error_cantidades != 0) { error++;}
        if (trims_entrega_seleccionados == 0) { error++;}
        if (error == 0) {
            enviar_datos_entrega();
            $("#load_trim").css('display', 'none');
        } else {
            $("#load_trim").css('display', 'none');
            if (trims_entrega_seleccionados == 0) { alertify.alert('Error!', 'Select an item, please'); }
            else {
                if (error_cantidades != 0) {
                    alertify.alert('Error!', 'Check your quantities, please');
                } else {
                    alertify.alert('Error!', 'Check empty fields, please');
                }
            }
            event.preventDefault();
            return false;
        }
    }
    function enviar_datos_entrega() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/guardar_entrega',
            data: "{'pedido':'" + $("#caja_pedido_entrega").val() + "','request':'" + request_e + "','cantidad':'" + cantidad_e + "','entrega':'" + nombre_entrega_e + "','recibe':'" + nombre_recibe_e + "','original':'" + original_e + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                $("#caja_nombre_entrega").val("");
                $("#caja_nombre_recibe").val("");
                $("#modal_formulario_entrega").modal("hide");
                $("#load_trim").css('display', 'none');
                $(".rows_tabla_trims_entrega").html("");
                $("#caja_pedido_entrega").val("");
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }
    function buscar_entregas_fechas(event) {
        $("#load_trim").css('display', 'inline');
        if ($("#caja_inicio_entrega").val() != '' && $("#caja_final_entrega").val() != '') {
            $.ajax({
                url: '/Trims/buscar_entregas',
                data: "{'inicio':'" + $("#caja_inicio_entrega").val() + "','final':'" + $("#caja_final_entrega").val() + "'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    //<tr><th>Date</th><th>Deliver</th><th>Receive</th><th>Order</th><th>Item</th><th>Total</th></tr>
                    var html = '';
         //<th>Date</th> <th>Deliver</th> <th>Receive</th> <th>Order</th> <th>Style</th> <th>Item</th> <th>Total order</th> <th>Total delivered</th>
                    $.each(result, function (key, item) {
                        var items = 0;
                        html += '<tr>';
                        $.each(item.lista_request, function (key, i) { items++; });
                        html += '<td rowspan="' + items + '" style="vertical-align:middle;">' + item.fecha + '</td>';
                        html += '<td rowspan="' + items + '" style="vertical-align:middle;">' + item.entrega + '</td>';
                        html += '<td rowspan="' + items + '" style="vertical-align:middle;">' + item.recibe + '</td>';
                        html += '<td rowspan="' + items + '" style="vertical-align:middle;">' + item.pedido + '</td>';
                        $.each(item.lista_request, function (key, i) {
                            html += '<td>' + i.estilo + '</td>';
                            html += '<td>' + i.item + '</td>';
                            html += '<td>' + i.cantidad + '</td>';
                            html += '<td>' + i.total + '</td>';
                            html += '</tr>';
                        });

                    });
                    $(".rows_tabla_historial_entregas").html(html);
                    $("#load_trim").css('display', 'none');
                }
            });

        } else {
            alertify.alert('Error!', 'Check empty fields, please');
            event.preventDefault();
            return false;
        }
    }
    $(document).on("click", ".close", function () {
        $('input').val('');
    });
    //btn_listado_entregas
    $(document).on("click", ".btn_listado_entregas", function () {
        llenar_po_listado_entrega();
        $('#caja_inicio_entrega').val('');
        $('#caja_final_entrega').val('');
        $('#caja_pedido_busqueda_entrega').val(0);
        $('#div_estilos_busqueda_entrega').css('display', 'none');
        $(".rows_tabla_historial_entregas").html('');
    });
    function llenar_po_listado_entrega() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $(".pedido_busqueda_entrega").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("change", "#caja_pedido_busqueda_entrega", function () {
        $.ajax({
            url: '/Trims/buscar_solo_estilos',
            contentType: 'application/json',
            data: "{'pedido':'" + $("#caja_pedido_busqueda_entrega").val() + "'}",
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                var result = jsonData.Data.estilos;
                var html = '';
                html += '<label for="caja_pedido_request">Style</label><select class="form-control  estilos_request " style="" id="caja_estilo_listado_entregas" >';//'<label class="">PO&nbsp;</label> <select class="form-control js-example-basic-single" id="caja_pedido" >';
                html += '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_po_summary + '">' + item.estilo + ' ' + item.descripcion + '</option>';
                });
                html += '</select>';
                $("#div_estilos_busqueda_entrega").css('display', 'inline');
                $("#div_estilos_busqueda_entrega").html(html);
                $("#load_trim").css('display', 'none');

            }
        });
    });
    $(document).on("change", "#caja_estilo_listado_entregas", function () {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_entregas_estilo',
            data: "{'summary':'" + $("#caja_estilo_listado_entregas").val() + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                //<tr><th>Date</th><th>Deliver</th><th>Receive</th><th>Order</th><th>Item</th><th>Total</th></tr>
                var html = '';
                $.each(result, function (key, item) {
                    var items = 0;
                    html += '<tr>';
                    $.each(item.lista_request, function (key, i) { items++; });
                    html += '<td rowspan="' + items + '" style="vertical-align:middle;">' + item.fecha + '</td>';
                    html += '<td rowspan="' + items + '" style="vertical-align:middle;">' + item.entrega + '</td>';
                    html += '<td rowspan="' + items + '" style="vertical-align:middle;">' + item.recibe + '</td>';
                    html += '<td rowspan="' + items + '" style="vertical-align:middle;">' + item.pedido + '</td>';
                    $.each(item.lista_request, function (key, i) {
                        html += '<td>' +i.estilo+' </td><td>'+ i.item + '</td>';
                        html += '<td>' + i.cantidad + '</td>';
                        html += '<td>' + i.total + '</td>';
                        html += '</tr>';
                    });
                });
                $(".rows_tabla_historial_entregas").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    });
    /*******************ENTREGA**DE**TRIMS*****************************************************************************************************************************/
    /*******************C*O*L*O*R*E*S***********************************************************************************************************************************/
    $(document).on("dblclick", "#tabla_ordenes_inicio tr", function () {
        
        var row = this.rowIndex;
        //if (row != 0) {
            obtener_informacion_trims_orden($('#tabla_ordenes_inicio tr:eq(' + row + ') td:eq(0)').html());
            $("#modal_trim_state").modal("show");
       // }
    });
    function obtener_informacion_trims_orden(pedido) {
        debugger
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/obtener_estado_total_pedido',
            data: "{'pedido':'" +pedido + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (p) {
                var html = '';
                $("#titulo_colores").html(p.pedido);
                if (p.id_customer == 1) {
                    $('#tabla_trim_state_po tr:eq(0) td:eq(1)').css("background-color", "#ffcbe5");
                }
                $('#tabla_trim_state_po tr:eq(0) td:eq(1)').html(p.customer);
                $('#tabla_trim_state_po tr:eq(0) td:eq(3)').html(p.ship_date);
                $('#tabla_trim_state_po tr:eq(1) td:eq(1)').html(p.gender);
                var empaque = '';
                $.each(p.lista_empaque, function (key, e) {
                    if (e.tipo_empaque == 1) {
                        empaque += '<p>BP';
                        $.each(e.lista_ratio, function (key, lr) {
                            empaque += ' '+lr.talla+':'+lr.ratio +' /';
                        });
                    } else {
                        empaque += '<p>PPK';
                        $.each(e.lista_ratio, function (key, lr) {
                            empaque += ' ' + lr.ratio + '&nbsp;';
                        });
                    }
                    empaque += '</p>';
                });
                $.each(p.lista_assort, function (key, item) { //ASSORMENTS EN LISTA DE ESTILOS
                    empaque += '<p>ASSORT '+item.cartones+' Cartons</p>';
                });
                $('#tabla_trim_state_po tr:eq(1) td:eq(3)').html(empaque);
                //<tr><th>Family</th><th>Style</th><th>Size</th><th>Item</th><th>Total</th><th>Received</th><th>Audited</th><th>MP Number</th><th>Receive date</th>STATUS</tr>
                $.each(p.lista_families, function (key, item) {
                    var items = 0;
                    $.each(item.lista_requests, function (key, x) { items++; });
                    //html += '<tr>';
                    if (items == 0) {
                        //html += '';
                        html += '<tr><td style="vertical-align:middle;  " class="cabecera_tabla2" >' + item.family_trim + '</td>';
                        html += '<td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>';
                       // html += '';
                    } else {
                        if (items > 1) { items++; }
                        var total_total = 0,total_cantidad=0;
                        html += '<tr>';
                        html += '<td rowspan="' + items + '" style="vertical-align:middle; width:21%; " class="cabecera_tabla2">' + item.family_trim + '</td>';
                        $.each(item.lista_requests, function (key, i) {
                            var color = '';
                            if (i.id_estado == 1) { color = '#ffff7a'; }
                            else {
                                if (i.id_estado == 2) { color = '#ff8585'; }
                                else { color = '#aefcae'; }
                            }
                            html += '<td style="background:' + color + '; border: none; width:20%;" >' + i.estilo + '</td>';
                            html += '<td style="background:' + color + '; border: none; width:5%;" >' + i.talla + '</td>';
                            html += '<td style="background:' + color + '; border: none; width:20%;" >' + i.item + '</td>';
                            html += '<td style="background:' + color + '; border: none; width:5%;" >' + i.total + '</td>';
                            total_total += i.total;
                            html += '<td style="background:' + color + '; border: none; width:5%;" >' + i.cantidad + '</td>';
                            total_cantidad += i.cantidad;
                            if (i.id_inventario == 0) {
                                html += '<td style="background:' + color + '; border: none;  width:8%;" ></td><td style="background:' + color + '; border: none;  width:8%;" ></td>';
                                //html += '';
                            } else {
                                html += '<td style="background:' + color + '; border: none; width:8%;" >' + i.recibo_item.mp_number + '</td>';
                                html += '<td style="background:' + color + '; border: none; width:8%;" >' + i.recibo_item.fecha + '</td>';
                            }
                            html += '<td style="background:' + color + '; border: none; width:8%;" >' + i.estado + '</td>';
                            html += '</tr>';
                        });
                        if (items > 1) {
                            html += '<td style="width:20%;"></td><td style="width:5%;"></td><td style="width:20%;"><b>TOTAL</b></td><td style="width:5%;"><b>' + total_total + '</b></td><td style="width:5%;"><b>' + total_cantidad + '</b></td><td style="width:8%;"></td><td style="width:8%;"></td><td style="width:8%;"></td></tr>';
                        }
                    }
                });
                $(".rows_tabla_trim_state_family").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }

    /*******************C*O*L*O*R*E*S***********************************************************************************************************************************/
    /*******************E*X*C*E*L***************************************************************************************************************************************/
    function excel_estados_pedidos_trim() {
        if ($("#caja_estado_inicio").val() != '' && $("#caja_estado_final").val() != '') {
            var dateReg = /([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))/;
            if (dateReg.test($("#caja_estado_inicio").val()) && dateReg.test($("#caja_estado_final").val())  ) {
                if (Date.parse($("#caja_estado_inicio").val()) <= Date.parse($("#caja_estado_final").val())) {
                    $.ajax({
                        url: '/Trims/sesiones_fechas',
                        data: "{'inicio':'" + $("#caja_estado_inicio").val() + "','final':'" + $("#caja_estado_final").val() + "'}",
                        contentType: 'application/json',
                        dataType: 'json',
                        type: 'post',
                        success: function (jsonData) {
                        }
                    });
                    $("#espera_t").css('display', 'inline');
                    var boton = document.getElementById('link_excel_estados_trim_fechas');
                    setTimeout(function () { $("#espera_t").css('display', 'none'); }, 2000);
                    boton.click();
                }
            }
        }
    }
    /*******************E*X*C*E*L***************************************************************************************************************************************/
    /*******************L*O*C*A*T*I*O*N*S*******************************************************************************************************************************/
    $(document).on("click", ".btn_agregar_locaciones", function () {
        //$("#load_trim").css('display', 'inline');
        llenar_po_locations();
    });
    function llenar_po_locations() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $(".pedidos_local").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    var trims_locations_seleccionados;
    $(document).on("change", "#caja_pedido_local", function () {
        $(".rows_tabla_trims_locations").html("");
        $("#div_tabla_trims_locations").css('visibility', 'hidden');
        buscar_locaciones_pedido();
    });
    function buscar_locaciones_pedido() {
        $("#load_trim").css('display', 'inline');
        var contador = 0;
        $.ajax({
            url: '/Trims/buscar_trims_pedido_localtion',
            contentType: 'application/json',
            data: "{'pedido':'" + $("#caja_pedido_local").val() + "'}",
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                var result = jsonData.Data.trims_anteriores;
                $("#load_trim").css('display', 'inline');
                var html = '';
                $.each(result, function (key, item) {
                    $.each(item.lista_requests, function (key, i) {
                        if (i.entregado < i.total) {
                            html += '<tr>';
                            html += '<td>' + i.id_request + '</td>';
                            html += '<td>' + item.estilo + '</td>';
                            html += '<td>' + i.item + '</td>';
                            html += '<td>' + i.total + '</td>';
                            html += '<td>' + i.cantidad + '</td>';
                            html += '<td><input  style="width:8em;" type="text" class=" form-control numeric " ondrop="return false;" onpaste="return false;" value="' + i.cantidad + '" maxlength="10" id="caja_sm"></td>';
                            html += '<td style="visibility:hidden; width:1em;"><input type="checkbox"  class="custom-control-input" id="cblocation_' + i.id_request + '"></td>';
                            html += '</tr>';
                            contador++;
                        }
                    });
                });
                trims_locations_seleccionados = 0;
                $(".rows_tabla_trims_locations").html(html);
                if (contador != 0) {
                    $("#div_tabla_trims_locations").css('visibility', 'visible');
                } else {
                    alertify.alert('Error!', 'All trims are saved');
                }
                $("#load_trim").css('display', 'none');
            }
        });
    }

    $(document).on("click", "#tabla_trims_locations tr", function () {
        var row = this.rowIndex;
        var chekbox = $('#tabla_trims_locations tr:eq(' + row + ')  td:nth-child(1)').html();
        if (this.style.background == "" || this.style.background == "white") {
            $("#cblocation_" + chekbox).prop('checked', true);
            $(this).css('background', '#46a772');
            $(this).css('color', 'white');
            trims_locations_seleccionados++;
        } else {
            $("#cblocation_" + chekbox).prop('checked', false);
            $(this).css('background', 'white');
            $(this).css('color', 'black');
            trims_locations_seleccionados--;
        }
    });
    var request_l, cantidad_l;
    function agregar_locaciones(event) {
        var error = 0, error_cantidades = 0;
        cantidad_l = ''; request_l = '';
        if ($("#caja_location").val() == '') {
            $("#caja_location").css('border', '2px solid #e03f3f');
            error++;
        } else {
            $("#caja_location").css('border', '1px solid #cccccc');
        }
        if (trims_locations_seleccionados == 0) { error++; }
        $("#load_trim").css('display', 'inline');

        $('#tabla_trims_locations tbody tr').each(function () {
            if ($(this).find('td:eq(6) input').is(":checked")) {
                if (parseFloat($(this).find('td:eq(4) ').html()) < parseFloat($(this).find('td:eq(5) input').val())) { error_cantidades++; }
                if (parseFloat($(this).find('td:eq(4) input').val()) == 0) { error_cantidades++; }
                if ($(this).find('td:eq(5) input').val() == '') { error_cantidades++; }
                request_l += "*" + $(this).find('td:eq(0) ').html();
                cantidad_l += "*" + $(this).find('td:eq(5) input').val();
            }
        });

        if (error_cantidades != 0) { error++; }
        if (error == 0) {
            enviar_datos_locaciones();
            $("#load_trim").css('display', 'none');
        } else {
            $("#load_trim").css('display', 'none');
            if (trims_locations_seleccionados == 0) { alertify.alert('Error!', 'Select an item, please'); }
            else {
                if (error_cantidades != 0) {
                    alertify.alert('Error!', 'Check your quantities, please');
                } else {
                    alertify.alert('Error!', 'Check empty fields, please');
                }
            }
            event.preventDefault();
            return false;
        }

    }
    function enviar_datos_locaciones() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/guardar_locaciones',
            data: "{'locacion':'" + $("#caja_location").val() + "','request':'" + request_l + "','cantidad':'" + cantidad_l + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                $("#caja_location").val("");
                buscar_locaciones_pedido();
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }
    /*******************L*O*C*A*T*I*O*N*S*******************************************************************************************************************************/
    /*******************T*R*I*M**S*T*A*T*E*L*O*C*A*T*I*O*N*S*************************************************************************************************************/
    //btn_location_state
    $(document).on("click", ".btn_location_state", function () {
        //$("#load_trim").css('display', 'inline');
        llenar_po_locations_state();
    });
    function llenar_po_locations_state() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $(".pedidos_local_state").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("change", "#caja_pedido_local_state", function () {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/obtener_estado_total_pedido_location',
            data: "{'pedido':'" + $("#caja_pedido_local_state").val()+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (p) {
                var html = '';
                $("#div_resultados_trim_location").css('display', 'inline');
                $("#titulo_locaciones_estado").html(p.pedido);
                if (p.id_customer == 1) {
                    $('#tabla_trim_location_state_po tr:eq(0) td:eq(1)').css("background-color", "#ffcbe5");
                }
                $('#tabla_trim_location_state_po tr:eq(0) td:eq(1)').html(p.customer);
                $('#tabla_trim_location_state_po tr:eq(0) td:eq(3)').html(p.ship_date);
                $('#tabla_trim_location_state_po tr:eq(1) td:eq(1)').html(p.gender);
               ///<th>Family</th><th>Style</th><th>Size</th><th>Item</th><th>Total Order</th><th>Location</th><th>Location details</th><th>Delivered</th><th>Delivery details</th>
                $.each(p.lista_families, function (key, item) {
                    var items = 0;
                    $.each(item.lista_requests, function (key, x) { items++; });
                    if (items == 0) {
                        html += '<tr><td style="vertical-align:middle;  " class="cabecera_tabla2" >' + item.family_trim + '</td>';
                        html += '<td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>';
                    } else {
                        html += '<tr>';
                        html += '<td rowspan="' + items + '" style="vertical-align:middle; width:15%; " class="cabecera_tabla2">' + item.family_trim + '</td>';
                        $.each(item.lista_requests, function (key, i) {
                            var color = '';
                            if (i.entregado == i.total) { color = '#85ff85'; }
                            ///<th>Delivered</th><th>Delivery details</th>
                            html += '<td style=" background:' + color + ';  width:14%;" >' + i.estilo + '</td>';
                            html += '<td style=" background:' + color + ';  width:5%;" >' + i.talla + '</td>';
                            html += '<td style=" background:' + color + ';  width:15%;" >' + i.item + '</td>';
                            html += '<td style="background:' + color + ';  width:5%;" >' + i.total + '</td>';
                            //html += '<td style="background:' + color + '; border: none;" >' + i.cantidad + '</td>';
                            var locations = '',location_details='';
                            $.each(i.lista_locations, function (key, l) {
                                locations += '<p>' + l.location + '</p>';
                                if (l.location == 'LUCKY') { color = '#ffff7a'; }
                                location_details += '<p>'+ l.fecha + ' ' + l.usuario + ' ' + l.total + '</p>';
                            });
                            if (i.location == 1) {
                                html += '<td style="background:' + color + ';  width:5%;" >' + locations + '</td>';
                                html += '<td style="background:' + color + ';  width:18%;" >' + location_details + '</td>';
                            } else {
                                html += '<td style=" width:5%;"></td><td style=" width:18%;"></td>';
                            }
                            var entrega = '', entrega_detalles = '';;
                            $.each(i.lista_entrega, function (key, e) {
                                entrega += '<p>' + e.total + '</p>';
                                entrega_detalles += '<p>' + e.fecha + ' \nFrom ' + e.entrega + ' to ' + e.recibe + '</p>';
                            });
                            if (i.entrega == 1) {
                                html += '<td style="background:' + color + ';  width:5%;" >' + entrega + '</td>';
                                html += '<td style="background:' + color + ';  width:18%;" >' + entrega_detalles + '</td>';
                            } else {
                                html += '<td style=" width:5%;"></td><td style=" width:18%;"></td>';
                            }
                            html += '</tr>';
                        });
                    }
                });
                $(".rows_tabla_trim_location_state_family").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    });
    /*******************T*R*I*M**S*T*A*T*E*L*O*C*A*T*I*O*N*S*************************************************************************************************************/
    /*******************A*R*C*H*I*V*O**E*X*CE*L******P*R*I*C*E**T*I*C*K*E*T*S********************************************************************************************/
    $(document).on("click", ".btn_subir_archivo", function () {
        $("#div_formulario_archivo").css('display','inline');
        llenar_po_subir_archivo();
        $(".rows_tabla_price_ticket").html('');
        $("#div_tabla_price_ticket").css('visibility', 'hidden');
    });
    $(document).on("click", "#boton_back_pt", function () {
        $("#div_formulario_archivo").css('display','inline');
        llenar_po_subir_archivo();
        $(".rows_tabla_price_ticket").html('');
        $("#div_tabla_price_ticket").css('visibility', 'hidden');
    });
    function llenar_po_subir_archivo() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $(".pedidos_subir_archivos").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("click", "#btnUpload", function () {
        $("#load_trim").css('display', 'inline');
        var archivo = $("#FileUpload1").val();
        if ($("#caja_pedido_subir_archivos").val() != 0) {
            if (archivo.indexOf("xlsx") >= 0 || archivo.indexOf("xls") >= 0 || archivo.indexOf("xlsm") >= 0) {
                guardar_sesion_pedido();
                // Checking whether FormData is available in browser
                if (window.FormData !== undefined) {
                    var fileUpload = $("#FileUpload1").get(0);
                    var files = fileUpload.files;
                    // Create FormData object
                    var fileData = new FormData();
                    // Looping over all files and add it to FormData object
                    for (var i = 0; i < files.length; i++) { fileData.append(files[i].name, files[i]); }
                    // Adding one more key to FormData object
                    fileData.append('username', 'Manas');
                    $.ajax({
                        url: '/Trims/UploadFiles',
                        type: "POST",
                        contentType: false, // Not to set any content header
                        processData: false, // Not to process data
                        data: fileData,
                        success: function (jsonData) {
                            var html = ''; var contador = 1;
                            var id_pedido = jsonData.Data.id_pedido;
                            var pedido = jsonData.Data.pedido;
                            $("#titulo_pedido_price_tickets").html("Order "+pedido);
                            var lista = jsonData.Data.lista;
                            $("#div_formulario_archivo").css('display', 'none');
                            $("#id_pedido_hidden").val(id_pedido);

                            $.each(lista, function (key, item) {
                                html += '<tr>';
                                html += '<td>' + contador + '</td>';
                                if (item.estado == 0) { html += '<td>Found</td>'; } else { html += '<td>Not found</td>'; }

                                var po = (item.total).split('*');
                                html += '<td>';
                                $.each(po, function (key, i) { html += '<input type="radio" class="totales_radio" name="total_' + contador + '" value="' + i + '" checked > ' + i + '<br>'; });
                                html += '</td>';

                                var style = (item.estilo).split('*');
                                html += '<td>';
                                $.each(style, function (key, i) { html += '<input type="radio" name="estilo_' + contador + '" value="' + i + '" checked > ' + i + '<br>'; });
                                html += '</td>';

                                var upc = (item.upc).split('*');
                                html += '<td>';
                                $.each(upc, function (key, i) { html += '<input type="radio" name="upc_' + contador + '" value="' + i + '" checked > ' + i + '<br>'; });
                                html += '</td>';

                                var descripcion = (item.descripcion_estilo).split('*');
                                html += '<td>';
                                $.each(descripcion, function (key, i) { html += '<input type="radio" name="descripcion_' + contador + '" value="' + i + '" checked > ' + i + '<br>'; });
                                html += '</td>';

                                var color = (item.color).split('*');
                                html += '<td>';
                                $.each(color, function (key, i) { html += '<input type="radio" name="color_' + contador + '" value="' + i + '" checked > ' + i + '<br>'; });
                                html += '</td>';

                                var tallas = (item.talla).split('*');
                                html += '<td>';
                                $.each(tallas, function (key, i) { html += '<input type="radio" name="talla_' + contador + '" value="' + i + '" checked > ' + i + '<br>'; });
                                html += '</td>';

                                html += '<td>' + item.tickets + '</td>';
                                html += '<td>' + item.dept + '</td>';
                                html += '<td>' + item.clas + '</td>';
                                html += '<td>' + item.sub + '</td>';
                                html += '<td>' + item.retail + '</td>';
                                html += '<td>' + item.cl + '</td>';

                                html += '</tr>';
                                contador++;
                            });
                            $(".rows_tabla_price_ticket").html(html);
                            $("#div_tabla_price_ticket").css('visibility', 'visible');
                            $("#load_trim").css('display', 'none');
                        },
                        error: function (err) { alert(err.statusText); }
                    });
                } else {
                    $("#load_trim").css('display', 'none');
                    alert("FormData is not supported.");
                }
            } else {
                $("#load_trim").css('display', 'none');
                alertify.alert('Error!', 'File not supported, please select an excel file');
            }
        } else {
            $("#load_trim").css('display', 'none');
            alertify.alert('Error!', 'Check empty fields, please');
        }
    });
    function guardar_sesion_pedido() {
        $.ajax({
            url: '/Trims/guardar_pedido_sesion',
            data: "{'pedido':'" + $("#caja_pedido_subir_archivos").val()+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {

            }
        });
    }
    var total, estilo, upc, descripcion, color, talla, ticket, dept,clas, sub, retail, cl;
    function guardar_price_tickets(event) {
        total = ''; estilo = ''; upc = ''; descripcion = ''; color = ''; talla = ''; ticket = ''; dept = ''; clas = ''; sub = ''; retail = ''; cl = '';
        var indice, impreso=0;
        $('#tabla_price_ticket tbody tr').each(function () {
            indice = $(this).find('td:eq(0)').html();
            total += '*' + $('input[name="total_'+indice+'"]:checked').val();
            estilo += '*' + $('input[name="estilo_' + indice + '"]:checked').val();
            upc += '*' + $('input[name="upc_' + indice + '"]:checked').val();
            descripcion += '*' + $('input[name="descripcion_' + indice + '"]:checked').val();
            color += '*' + $('input[name="color_' + indice + '"]:checked').val();
            talla += '*' + $('input[name="talla_' + indice + '"]:checked').val();
            if ($(this).find('td:eq(8) ').html() != '') { ticket += '*' + $(this).find('td:eq(8) ').html(); } else { ticket += '*0'; }
            if ($(this).find('td:eq(9) ').html() != '') { dept += '*' + $(this).find('td:eq(9) ').html(); } else { dept += '*0'; }
            if ($(this).find('td:eq(10) ').html() != '') { clas += '*' + $(this).find('td:eq(10) ').html(); } else { clas += '*0'; }
            if ($(this).find('td:eq(11) ').html() != '') { sub += '*' + $(this).find('td:eq(11) ').html(); } else { sub += '*0'; }
            if ($(this).find('td:eq(12) ').html() != '') { retail += '*' + $(this).find('td:eq(12) ').html(); } else { retail += '*N/A'; }
            if ($(this).find('td:eq(13) ').html() != '') { cl += '*' + $(this).find('td:eq(13) ').html(); } else { cl += '*N/A'; }
            //request_l += "*" + $(this).find('td:eq(0) ').html();
            //cantidad_l += "*" + $(this).find('td:eq(5) input').val();
        });
        if ($("#caja_impreso").is(":checked")) { impreso = 1; } else { impreso = 0; }
        $.ajax({
            url: '/Trims/guardar_price_tickets',
            data: "{'pedido':'" + $("#id_pedido_hidden").val() + "','total':'" + total +"','estilo':'" + estilo +"','upc':'" + upc +"','descripcion':'" + descripcion +"','color':'" + color +"','talla':'" + talla +"','ticket':'" + ticket +"','dept':'" + dept +"','clas':'" + clas +"','sub':'"+sub+"','retail':'"+retail+"','cl':'"+cl+"','impreso':'"+impreso+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                $("#caja_impreso").prop('checked', true);
                $("#modal_comparar_excel").modal("hide");
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }
    $(document).on("click", ".btn_buscar_pt", function () {
        $(".pedidos_buscar_pt").html('');
        llenar_po_buscar_pt();
        $(".rows_tabla_buscar_price_ticket").html('');
        $("#div_tabla_buscar_price_ticket").css('visibility', 'hidden');
    });
    function llenar_po_buscar_pt() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $(".pedidos_buscar_pt").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("change", "#caja_pedido_buscar_price_ticket", function () {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_price_tickets',
            data: "{'pedido':'" + $("#caja_pedido_buscar_price_ticket").val() + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    $("#titulo_buscar_price_tickets").html('ORDER ' + item.pedido);
                    html += '<tr>';
                    html += '<td>' + item.id_price_ticket + '</td>';
                    html += '<td>' + item.total + '</td>';
                    html += '<td>' + item.estilo + '</td>';
                    html += '<td>' + item.upc + '</td>';
                    html += '<td>' + item.descripcion_estilo + '</td>';
                    html += '<td>' + item.color + '</td>';
                    html += '<td>' + item.talla + '</td>';
                    html += '<td>' + item.tickets + '</td>';
                    html += '<td>' + item.dept + '</td>';
                    html += '<td>' + item.clas + '</td>';
                    html += '<td>' + item.sub + '</td>';
                    html += '<td>' + item.retail + '</td>';
                    html += '<td>' + item.cl + '</td>';
                    html += '<td>' + item.fecha+ '</td>';
                    html += '<td>' + item.usuario + '</td>';
                    html += '</tr>';
                });
                $(".rows_tabla_buscar_price_ticket").html(html);
                $("#div_tabla_buscar_price_ticket").css('visibility', 'visible');
                $("#load_trim").css('display', 'none');

            }
        });
    });
    var trims_tallas = ''; var total_trims_tallas;
    $(document).on("click", ".btn_ver_pt", function () {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_ordenes_pt',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                var total_estilos;
                $.each(result, function (key, item) {
                    total_estilos = 0;
                    $.each(item.lista_estilos, function (key, i) { total_estilos++; });
                    html += '<tr>';
                    if (total_estilos == 0) {
                        html += '<td>' + item.pedido + '</td>';
                        html += '<td>' + item.customer + '</td>';
                        html += '<td></td>';
                        html += '<td></td>';
                        html += '</tr>';
                    } else {
                        html += '<td rowspan="' + total_estilos + '">' + item.pedido + '</td>';
                        html += '<td rowspan="' + total_estilos + '">' + item.customer + '</td>';
                        $.each(item.lista_estilos, function (key, i) {
                            html += '<td>' + i.estilo + ' ' + i.descripcion + '</td>';
                            html += '<td>';
                            $.each(i.lista_trims, function (key, t) {
                                if (t.id_talla != 0) {
                                    if (t.impreso == 0 ) {
                                        html += '<input type="checkbox" class="trims_tallas_cb" id="' + t.id_request + '_' + t.id_inventario + '_' + t.total + '" />&nbsp;<label style="font-weight:normal; margin-left:0.5em;" for="' + t.id_request + '_' + t.id_inventario + '_' + t.total + '">' + t.talla + '</label>&nbsp;&nbsp; ';
                                    } else {
                                        html += '<span class="glyphicon glyphicon-check" aria-hidden="true"></span>&nbsp;<label style="font-weight:normal; margin-left:0.5em;" >' + t.talla + '</label>&nbsp;&nbsp;';
                                    }
                                }
                            });
                            html += '</td>';
                            html += '</tr>';
                        });
                    }
                });
                total_trims_tallas = 0;
                $(".rows_tabla_order_price_ticket").html(html);
                $("#load_trim").css('display', 'none');

            }
        });
    });
    $(document).on("change", ".trims_tallas_cb", function () {
        //var id = $(this).attr('id');
        if ($(this).is(":checked")) {
            total_trims_tallas++;
            $("#btn_marcar_pt").css('visibility', 'visible');
        } else {
            total_trims_tallas = total_trims_tallas - 1;
            if (total_trims_tallas == 0) {
                $("#btn_marcar_pt").css('visibility', 'hidden');
            }
        }
    });
    var prices_tickets_marcar;
    function obtener_datos_pt(event) {
        prices_tickets_marcar = '';
        $(".trims_tallas_cb").each(function () {
            if ($(this).is(":checked")) {
                prices_tickets_marcar += '*' + $(this).attr('id');
            }
        });
        $.ajax({
            url: '/Trims/marcar_pt_impreso',
            data: "{'informacion':'" + prices_tickets_marcar + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                $("#modal_ver_pt").modal("hide");
                $(".rows_tabla_order_price_ticket").html('');
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }

     /*******************A*R*C*H*I*V*O**E*X*CE*L******P*R*I*C*E**T*I*C*K*E*T*S********************************************************************************************/
     /*******************S*O*L*I*C*I*T*U*D**C*A*J*A*S**********************************************************************************************************************/
    $(document).on("click", "#btn_requ_cajas", function () {
        $("#div_estilos_boxes").css('display', 'none');
        $("#div_boton_estilos").css('display', 'none');
        $("#div_boton_pedido").css('display', 'none');
        $("#div_tabla_solicitud_cajas").css('display', 'none');
        //$("#boton_ver_estilo").css('display', 'none');
        // boton_ver_estilo div_boton_estilos div_boton_pedido
        llenar_po_solicitar_cajas();
    });
    function llenar_po_solicitar_cajas() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $(".pedidos_boxes").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("change", "#caja_pedido_boxes", function () {
        $("#div_boton_estilos").css('display', 'inline');
        $("#div_boton_pedido").css('display', 'inline');
        $("#div_estilos_boxes").css('display', 'none');
        $("#div_tabla_solicitud_cajas").css('display', 'none');
    });
    function ver_estilo() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_solo_estilos',
            contentType: 'application/json',
            data: "{'pedido':'" + $("#caja_pedido_boxes").val() + "'}",
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                var result = jsonData.Data.estilos;
                var html = '';
                html += '<label for="caja_pedido_request">Style</label><select class="form-control  estilos_request " style="" id="caja_estilo_boxes" >';//'<label class="">PO&nbsp;</label> <select class="form-control js-example-basic-single" id="caja_pedido" >';
                html += '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_po_summary + '">' + item.estilo + ' ' + item.descripcion + '</option>';
                });
                html += '</select>';
                $("#div_estilos_boxes").css('display', 'inline');
                $("#div_boton_estilos").css('display', 'none');
                $("#div_estilos_boxes").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    var contador_solicitud_cajas;
    function ver_cajas_orden() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_cajas_orden',
            contentType: 'application/json',
            data: "{'pedido':'" + $("#caja_pedido_boxes").val() + "'}",
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                llenar_tabla_solicitud(jsonData.Data.cajas);
                $('#caja_estilo_boxes').val(0);
            }
        });
    }
    $(document).on("change", "#caja_estilo_boxes", function () {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_cajas_estilo',
            contentType: 'application/json',
            data: "{'summary':'" + $("#caja_estilo_boxes").val() + "'}",
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                llenar_tabla_solicitud(jsonData.Data.cajas);
            }
        });
    });
    function llenar_tabla_solicitud(cajas) {
        var html = '';
        $.each(cajas, function (key, item) {
            //<th>#</th><th>Box</th><th>Order quantity</th><th>Total</th><th style="visibility:hidden;width:.5em;"></th>
            if ((item.total - item.cantidad) >= 1) {
                html += '<tr>';
                html += '<td>' + item.id_request + '</td>';
                html += '<td>' + item.item + '</td>';
                html += '<td>' + (item.total - item.cantidad) + '</td>';
                html += '<td><input  style="width:8em;" type="text" class=" form-control numeric " ondrop="return false;" onpaste="return false;" value="' + (item.total - item.cantidad) + '" maxlength="5" ></td>';
                html += '<td style="visibility:hidden; width:1em;"><input type="checkbox"  class="custom-control-input" id="cbBoxReq_' + item.id_request + '"></td>';
                html += '<td style="visibility:hidden; width:1em;">' + item.id_summary + '</td>';
                html += '</tr>';
            }
        });
        contador_solicitud_cajas = 0;
        $("#div_tabla_solicitud_cajas").css('display', 'inline');
        $(".body_tabla_solicitud_cajas").html(html);
        $("#load_trim").css('display', 'none');
    }
    $(document).on("click", "#tabla_solicitud_cajas tr", function () {
        var row = this.rowIndex;
        if (row != 0) {
            var chekbox = $('#tabla_solicitud_cajas tr:eq(' + row + ')  td:nth-child(1)').html();
            if (this.style.background == "" || this.style.background == "white") {
                $("#cbBoxReq_" + chekbox).prop('checked', true);
                $(this).css('background', '#6fa746');
                $(this).css('color', 'white');
                contador_solicitud_cajas++;
                $('#boton_guardar_boxes_request').css('display', 'inline');
            } else {
                $("#cbBoxReq_" + chekbox).prop('checked', false);
                $(this).css('background', 'white');
                $(this).css('color', 'black');
                contador_solicitud_cajas--;
                if (contador_solicitud_cajas == 0) {
                    $('#boton_guardar_boxes_request').css('display', 'none');
                }
            }
        }
    });
    //GUARDAR E IMPRIMIR
    var summary_cajas, request_cajas, total_cajas,items_cajas;
    function guardar_boxes_request(event) {
        summary_cajas = ''; request_cajas = ''; total_cajas = ''; items_cajas = '';
        var error = 0;
        $('#tabla_solicitud_cajas tbody tr').each(function () {
            if ($(this).find('td:eq(4) input').is(":checked")) {
                if (parseFloat($(this).find('td:eq(2) ').html()) < parseFloat($(this).find('td:eq(3) input').val())) {
                    error++;
                    $(this).find('td:eq(3) input').css('border', '2px solid #e03f3f');
                }
                if (parseFloat($(this).find('td:eq(3) input').val()) == 0 || $(this).find('td:eq(3) input').val()=='' ) {
                    error++;
                    $(this).find('td:eq(3) input').css('border', '2px solid #e03f3f');
                }
                summary_cajas += "*" + $(this).find('td:eq(5) ').html();
                request_cajas += "*" + $(this).find('td:eq(0) ').html();
                total_cajas += "*" + $(this).find('td:eq(3) input').val();
                items_cajas += "*" + $(this).find('td:eq(1) ').html();
            }
        });
        if (error == 0) {
            $("#load_trim").css('display', 'inline');
            $.ajax({
                url: '/Trims/guardar_solicitud_cajas',
                contentType: 'application/json',
                data: "{'request':'" + request_cajas + "','summary':'" + summary_cajas + "','total':'" + total_cajas + "','item':'" + items_cajas+"'}",
                dataType: 'json',
                type: 'post',
                success: function (data) {
                    $("#load_trim").css('display', 'none');
                    $("#modal_solicitar_cajas").modal('hide');
                }
            });
        } else {
            alertify.alert('Error!', 'Check your quantities, please');
            event.preventDefault();
            return false;
        }
    }
    function print() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/Downloadexcel',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (Rdata) {

                var bytes = new Uint8Array(Rdata.FileContents);
                var blob = new Blob([bytes], {
                    type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
                });
                var link = document.createElement('a');
                link.href = window.URL.createObjectURL(blob);
                link.download = "myFileName.xlsx";
                link.click();
                $("#load_trim").css('display', 'none');
            },
        });
    }
     /*******************S*O*L*I*C*I*T*U*D**C*A*J*A*S**********************************************************************************************************************/
     /*******************R*E*C*I*B*O*S**T*R*I*M*S**************************************************************************************************************************/
    //btn_nueva_transferencia_trim
    $(document).on("click", ".btn_nuevo_recibo_trim", function () {
        llenar_po_recibo_trims();
        llenar_clientes_recibo();
        llenar_tabla_items();
        llenar_sucursales_recibo();
        contador_trims_recibos = 0;
        $("#div_tabla_trims_recibos").css('visibility','hidden');
        $(".body_tabla_trims_recibos").html('');
    });
    ///cliente_sucursal_trims
    var contador_trims_recibos;
    function llenar_tabla_items() {
        var busqueda = "";
        if ($("#caja_busqueda_recibo_trims").val() != '') {
            busqueda = $("#caja_busqueda_recibo_trims").val();
        } else {
            busqueda = 0;
        }
        $.ajax({
            url: '/Trims/buscar_items_recibos_trims',
            contentType: 'application/json',
            data:"{'busqueda':'"+busqueda+"'}",
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    html += '<tr>';
                    html += '<td style="width:6em;" >' + item.id_item + '</td>';
                    html += '<td style="width:10em;" >' + item.componente + '</td>';
                    html += '<td style="width:20em;" >' + item.descripcion + '</td>';
                    html += '<td style="width:6em;" >' + item.familia + '</td>';
                    html += '</tr>';
                });
                $(".body_tabla_trims_recibos_temporal").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function llenar_po_recibo_trims() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<option  value="0">NONE</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $(".pedidos_recibo_trims").html(html);

                $("#load_trim").css('display', 'none');
            }
        });
    }
    function llenar_clientes_recibo() {
        $.ajax({
            url: '/Trims/buscar_clientes',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_customer + '">' + item.customer + '</option>';
                });
                $(".cliente_recibo_trims").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function llenar_sucursales_recibo() {
        $.ajax({
            url: '/Trims/buscar_sucursales',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_sucursal + '">' + item.sucursal + '</option>';
                });
                $(".cliente_sucursal_trims").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    var estilos_trims_recibos;
    $(document).on("change", "#caja_pedido_recibo", function () {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_solo_estilos',
            contentType: 'application/json',
            data: "{'pedido':'" + $("#caja_pedido_recibo").val() + "'}",
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                estilos_trims_recibos = jsonData.Data.estilos;
                $("#load_trim").css('display', 'none');
                //$("#div_busqueda").css('visibility', 'visible');
            }
        });
    });

    $(document).on("dblclick", "#tabla_trims_recibos_temporal tr", function () {
        var row = this.rowIndex;
        var id = $('#tabla_trims_recibos_temporal tr:eq(' + row + ') td:eq(0)').html();
        var amt = $('#tabla_trims_recibos_temporal tr:eq(' + row + ') td:eq(1)').html();
        var descripcion = $('#tabla_trims_recibos_temporal tr:eq(' + row + ') td:eq(2)').html();
        agregar_fila_recibos(id + "&" + amt + "&" + descripcion );
    });
    function agregar_fila_recibos(data) {
        var datos = data.split('&');
        var html = '<tr>';
        html += '<td style="width:10%;">'+datos[0]+'</td>';
        html += '<td style="width:15%;">'+datos[1]+'</td>';
        html += '<td style="width:30%;">'+datos[2]+'</td>';
        html += '<td style="width:25%;"><select class="form-control  "  ><option  value="0">NONE</option>';
        $.each(estilos_trims_recibos, function (key, item) {
            html += '<option  value="' + item.id_estilo + '">' + item.estilo + ' ' + item.descripcion + '</option>';
        });
        html += '</select></td>';
        html += '<td style="width:15%;"><input ondrop="return false;" onpaste="return false;"  maxlength="5" class="numeric form-control cant_rec_trim " placeholder="QTY" /></td>';
        html += '<td style="width:5%;"><button type="button" class="btn btn-light delItemRecTrim"><b>-</b></button></td> ';
        html += '</tr>';
        $(".body_tabla_trims_recibos").append(html);
        contador_trims_recibos++;
        //$("#tabla_trims_recibos").css('visibility','visible');
        $("#div_tabla_trims_recibos").css('visibility','visible');
    }

    $(document).on("click", ".delItemRecTrim", function () {
        //tabla_trims_recibos
        var row = this.rowIndex;
        $(this).closest("tr").remove();
        contador_trims_recibos--;
        if (contador_trims_recibos == 0) {
            $("#div_tabla_trims_recibos").css('visibility', 'hidden');
        }
    });
    var pedido_recibo_trim, po_number_recibo_trim, mp_recibo_trim, item_recibo_trim, estilo_recibo_trim, cantidad_recibo_trim,packing_number_trim;
    function guardar_recibo_trims(event) {
        var error = 0;
        item_recibo_trim = ''; estilo_recibo_trim = ''; cantidad_recibo_trim = '';
        pedido_recibo_trim = $("#caja_pedido_recibo").val();
        po_number_recibo_trim = $("#caja_po_number_recibo").val();
        mp_recibo_trim = $("#caja_mp_recibo").val();
        packing_number_trim = $("#caja_packing_number_trim").val();
        $(".check_rec_trim").each(function () {
            if ($(this).val() == '') {
                $(this).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $(this).css('border', '1px solid #cccccc');
            }
        });
        $(".cant_rec_trim").each(function () {
            if ($(this).val() == '' || $(this).val() == '0') {
                $(this).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $(this).css('border', '1px solid #cccccc');
            }
        });
        if (error == 0) {
            $('#tabla_trims_recibos tbody tr').each(function () {
                item_recibo_trim += "*" + $(this).find('td:eq(0) ').html();
                cantidad_recibo_trim += "*" + $(this).find('td:eq(4) input').val();
                estilo_recibo_trim += "*" + $(this).find(":selected").val();
            });
            enviar_datos_recibo_trim();
        } else {
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function enviar_datos_recibo_trim() {
        $.ajax({
            url: '/Trims/guardar_recibo_trims',
            data: "{'pedido':'" + pedido_recibo_trim + "','mp':'" + mp_recibo_trim + "','po_number':'" + po_number_recibo_trim + "','item':'" + item_recibo_trim + "','estilo':'" + estilo_recibo_trim + "','cantidad':'" + cantidad_recibo_trim + "','packing_number':'" + packing_number_trim + "','cliente':'" + $("#caja_cliente_recibo").val() + "','sucursal':'" + $("#caja_sucursal_recibo").val()+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                $("#caja_pedido_recibo").val('');
                $("#caja_po_number_recibo").val('');
                $("#caja_mp_recibo").val('');
                $("#div_tabla_trims_recibos").css('visibility', 'hidden');
                $(".body_tabla_trims_recibos").html('');
                $("#div_busqueda").css('visibility', 'hidden');
                $("#modal_recibos_trims").modal("hide");
            }
        });
    }
   /*******************R*E*C*I*B*O*S**T*R*I*M*D**************************************************************************************************************************/
   /*******************I*N*V*E*N*T*A*R*I*O**T*R*I*M*S********************************************************************************************************************/
    //btn_list_trim  modal_lista_inventario_trim
    $(document).on("click", ".btn_list_trim", function () {
        cerrar_div_cambio_inventario();
        llenar_tabla_inventario_trims();  
    });
    function llenar_tabla_inventario_trims() {
        $("#load_trim").css('display', 'inline');
        var busqueda = "";
        if ($("#caja_busqueda_trim_inventario").val() != '') {
            busqueda = $("#caja_busqueda_trim_inventario").val();
        } else {
            busqueda = 0;
        }
        $.ajax({
            url: '/Trims/buscar_inventario_trims',
            contentType: 'application/json',
            data: "{'busqueda':'" + busqueda + "'}",
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    html += '<tr>';
                    html += '<td style="width:5%;" >' + item.id_inventario + '</td>';
                    html += '<td style="width:20%;" >' + item.descripcion + '</td>';
                    html += '<td style="width:10%;" >' + item.total + '</td>';
                    html += '<td style="width:15%;" >' + item.po + '</td>';
                    html += '<td style="width:20%;" >' + item.estilo + '</td>';
                    html += '<td style="width:10%;" >' + item.family_trim + '</td>';
                    html += '<td style="width:10%;" >' + item.customer + '</td>';
                    html += '<td style="width:10%;" ><button type="button" ToolTip=""  class="btn " onclick="cambiar_inventario(' + item.id_inventario + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-refresh" aria-hidden="true"  style="padding 0px !important;"></span> </button>';
                    html += '</td>';
                    html += '</tr>';
                });
                $(".body_tabla_trims_lista_inventario").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function buscar_inventario_tabla_trims(event) {
        if (event.keyCode == 13) {
            llenar_tabla_inventario_trims();
            //alert("dfdfds");
        }
    }
    var tiene_po,total_inventario;
    function cambiar_inventario(id) {
        $("#div_pedido_inventario_trim").css('visibility', 'hidden');  
        $('#tabla_trims_lista_inventario tbody tr').each(function () {
            //cantidad_recibo_trim += "*" + $(this).find('td:eq(4) input').val();
            if ($(this).find('td:eq(0) ').html() == id) {
                $("#caja_id_inventario_trim").val(id);
                $("#caja_cantidad_cambio_trim_inventario").val($(this).find('td:eq(2) ').html());
                $("#etiqueta_item_cambiar").val($(this).find('td:eq(1) ').html());
                total_inventario = $(this).find('td:eq(2) ').html();
                if ($(this).find('td:eq(3) ').html() == '') {
                    llenar_po_inventario_trims();
                    $("#div_pedido_inventario_trim").css('visibility', 'visible');                        
                    tiene_po = 0;
                } else {
                    $("#div_pedido_inventario_trim").css('visibility', 'hidden');                        
                    tiene_po = 1;
                }               
            }
        });
        $("#div_cambiar_inventario").css('visibility', 'visible');               
    }
    function llenar_po_inventario_trims() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<option  value="0">NONE</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $(".pedidos_inventario_trims").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function cambiar_inventario_trims(event) {
        var pedido = 0, estilo = 0;
        if ($("#caja_cantidad_cambio_trim_inventario").val() != '' && $("#caja_cantidad_cambio_trim_inventario").val() != '0' && parseFloat($("#caja_cantidad_cambio_trim_inventario").val()) <= parseFloat(total_inventario)) {
            $("#load_trim").css('display', 'inline');
            if (tiene_po == 0) {
                pedido = $('#caja_pedido_inventario').val();
                estilo = $('#caja_estilo_inventario').val();                
            } else {
                pedido = 0; estilo = 0;
            }
            $.ajax({
                url: '/Trims/cambiar_cantidades_inventario_trim',
                contentType: 'application/json',
                data: "{'inventario':'" + $('#caja_id_inventario_trim').val() + "','cantidad':'" + $('#caja_cantidad_cambio_trim_inventario').val() + "','pedido':'" +pedido + "','tiene_po':'" + tiene_po + "','estilo':'" +estilo+"'}",
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    cerrar_div_cambio_inventario();
                    llenar_tabla_inventario_trims();  
                    $("#load_trim").css('display', 'none');
                }
            });
        } else {
            event.preventDefault();
            $("#caja_cantidad_cambio_trim_inventario").css('border', '2px solid #e03f3f');
            alertify.alert('Error!', 'Check empty fields and/or your quantities, please');
            return false;
        }
    }
    function cerrar_div_cambio_inventario() {
        $("#div_pedido_inventario_trim").css('visibility', 'hidden');   
        $("#div_estilos_inventario").css('visibility', 'hidden');   
        $("#div_cambiar_inventario").css('visibility', 'hidden');
    }
    $(document).on("change", "#caja_pedido_inventario", function () {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_solo_estilos',
            contentType: 'application/json',
            data: "{'pedido':'" + $("#caja_pedido_inventario").val() + "'}",
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                var result = jsonData.Data.estilos;             
                var html = '';
                html += '<label for="caja_pedido_request">Style</label><select class="form-control  " style="" id="caja_estilo_inventario" >';//'<label class="">PO&nbsp;</label> <select class="form-control js-example-basic-single" id="caja_pedido" >';
                html += '<option  value="0">Select</option>';               
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_po_summary + '">' + item.estilo + ' ' + item.descripcion + '</option>';
                });
                html += '</select>';
                $("#div_estilos_inventario").css('visibility', 'visible');
                $("#div_estilos_inventario").html(html);             
                $("#load_trim").css('display', 'none');
                
            }
        });
    });
   /*******************I*N*V*E*N*T*A*R*I*O**T*R*I*M*S********************************************************************************************************************/
   /*******************R*E*P*O*R*T*E*************************************************************************************************************************************/
   $(document).on("click", ".btn_report_customer", function () {        
        llenar_pedidos_reporte_stock_customer();
    });
    function llenar_pedidos_reporte_stock_customer() {
        $.ajax({
            url: '/Trims/buscar_clientes',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_customer + '">' + item.customer + '</option>';
                });
                $(".customer_reporte_stock").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function reporte_stock_cliente(event) {
        $.ajax({
            url: '/Trims/reporte_customer_stock',
            data: "{'cliente':'" + $("#caja_customer_stock_reporte").val()+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {                
                $("#modal_reporte_stock_cliente").modal("hide");
                var boton = document.getElementById('link_excel_cutomer_stock');
                setTimeout(function () { $("#espera").css('display', 'none'); }, 3000);
                boton.click();
            }
        });
    }
   /*******************R*E*P*O*R*T*E*************************************************************************************************************************************/
</script>
<a id="link_trim_card" href="@Url.Action("trim_card", "Trims")" style="visibility:hidden;">Daily</a>
<a id="link_excel_estados_trim_fechas" href="@Url.Action("excel_trims_estados_fechas", "Trims")" style="visibility:hidden;">Daily</a>
<a id="link_excel_cutomer_stock" href="@Url.Action("excel_customer_stock", "Trims")" style="visibility:hidden;">Daily</a>
<style>
    input[type=checkbox] {
        /* Double-sized Checkboxes */
        -ms-transform: scale(2); /* IE */
        -moz-transform: scale(2); /* FF */
        -webkit-transform: scale(2); /* Safari and Chrome */
        -o-transform: scale(2); /* Opera */
        padding: 10px;
    }

    /* Might want to wrap a span around your checkbox text */
    .checkboxtext {
        /* Checkbox text */
        font-size: 110%;
        display: inline;
    }

    input[type='radio']:after {
        width: 15px;
        height: 15px;
        border-radius: 15px;
        top: -2px;
        left: -1px;
        position: relative;
        background-color: #a7afb5;
        content: '';
        display: inline-block;
        visibility: visible;
        border: 0px solid white;
    }

    input[type='radio']:checked:after {
        width: 15px;
        height: 15px;
        border-radius: 15px;
        top: -2px;
        left: -1px;
        position: relative;
        background-color: #ecaf2d;
        content: '';
        display: inline-block;
        visibility: visible;
        border: 0px solid white;
    }

    .cabecera_tabla2 {
        /*background:#3479bf; #46a772*/
        background: white;
        color: #3479bf;
        pointer-events: none;
        cursor: not-allowed;
    }

    .cabecera_tabla {
        /*background:#3479bf; #46a772*/
        background: #3479bf;
        color: white;
        pointer-events: none;
        cursor: not-allowed;
    }

    .select2-container--default .select2-selection--single {
        display: block !important;
        /*width: 100% !important;*/
        height: 34px !important;
        padding: 6px 12px !important;
        font-size: 14px !important;
        line-height: 1.42857143 !important;
        color: #555 !important;
        background-color: #fff !important;
        background-image: none !important;
        border: 1px solid #ccc !important;
        border-radius: 4px !important;
        -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075) !important;
        box-shadow: inset 0 1px 1px rgba(0,0,0,.075) !important;
        -webkit-transition: border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s !important;
        -o-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s !important;
        transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s !important;
    }

        .select2-container--default .select2-selection--single .select2-selection__rendered {
            color: #444;
            line-height: 20px;
        }

    .modal-dialog {
        width: 75% !important;
        padding: 2em;
        height: 90% !important;
        min-height: 90% !important;
    }

    .modal-content {
        height: 90% !important;
    }

    .modal-lg {
        max-width: 80% !important;
    }

    a {
        text-decoration: none !important;
    }

    .boton_barra_menu, .btn-info {
        color: #fff;
        background-color: #3479bf !important;
        border-color: #3479bf !important;
    }

    .modal {
        /*z-index: 4 !important;*/
    }

    .dataTables_filter {
    }

    .dropbtn {
        background-color: #3479bf;
        color: white;
        padding: 16px;
        /*padding: 0.40em;*/
        font-size: 18px;
        border: none;
    }

    .dropdown {
        position: relative;
        display: inline-block;
    }

    .dropdown-content {
        display: none;
        position: absolute;
        background-color: white;
        color: black;
        min-width: 160px;
        box-shadow: 1px 5px 25px 1px rgba(0,0,0,0.2);
        z-index: 1;
    }

        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

    .menu {
        background: #3479bf;
        border-radius: 5px;
        border: solid 1px #3479bf;
        margin-bottom: .5em;
        margin: 1em;
    }

    .dropdown-content a:hover {
        /*background-color: #f1f1f1;
        color: black;*/
        background-color: #61b363;
        color: white;
    }

    .dropdown:hover .dropdown-content {
        display: block;
    }


    .modal-header-primary {
        color: #fff;
        padding: 9px 15px;
        border-bottom: 1px solid #eee;
        background-color: #3479bf;
        -webkit-border-top-left-radius: 5px;
        -webkit-border-top-right-radius: 5px;
        -moz-border-radius-topleft: 5px;
        -moz-border-radius-topright: 5px;
        border-top-left-radius: 5px;
        border-top-right-radius: 5px;
    }

    .x {
        transition: transform .25s ease-in-out;
        color: white !important;
    }

        .x:hover {
            transform: rotate(180deg);
            color: white !important;
        }

        .x:before {
            transform: rotate(45deg);
            transform-origin: center;
        }

        .x:after {
            transform: rotate(-45deg);
            transform-origin: center;
        }

    tr {
        cursor: pointer;
    }
</style>
<input type="hidden" id="total_blanks_hidden">
<input type="hidden" id="id_pedido_hidden">
<div id="load_trim" class="load">
    <div id="spinner" class="imagen_loading" style=""></div>
</div>
<div id="espera_t" class="" style="display:none; z-index:999; position:absolute; top:0; left:0; width:100%; height:100%; background:white; opacity:0.6; ">
    <div id="" class="" style="float:left; background-image:url('../../Content/img/gif/preloader.gif'); background-repeat: no-repeat; width:300px; height:160px; position:absolute; left:45%; top:25%; "></div>
    <div id="" class="" style="float:left; font-size:2em; color:#3479bf; top:50%; position:absolute; left:36%; width:100%;">We are making the report, please wait a few seconds</div>
</div>

<div class="container-fluid" style="padding-left:7em; padding-right:3em;">
    <center><h2 style="color:#3479bf; font-weight:bold;">T R I M S</h2></center>

    <div class="row">
        <div class="menu">
            <div class="dropdown">
                <button class="dropbtn" type="button" href="#modal_formulario_nuevo_item" data-toggle="modal">
                    New trim
                </button>
            </div>

            <div class="dropdown">
                <button class="dropbtn">Items</button>
                <div class="dropdown-content">
                    <a href="#modal_editar_item" data-toggle="modal" class="btn_editar_item">Modify</a>
                </div>
            </div>

            <div class="dropdown">
                <button class="dropbtn">Receives</button>
                <div class="dropdown-content">
                    <a href="#modal_recibos_trims" data-toggle="modal" class="btn_nuevo_recibo_trim">New</a>
                    <a href="#modal_listado_recibos" data-toggle="modal" id="ver_recibos_trim">Report</a>
                </div>
            </div>
            <div class="dropdown">
                <button class="dropbtn">Material</button>
                <div class="dropdown-content">
                    <a href="#modal_request" data-toggle="modal" id="ver_request">Requests</a>
                    <a href="#modal_auditoria" data-toggle="modal" id="ver_auditoria">Audit</a>
                    <a href="@Url.Action("excel_material_pedir", "Trims")">List</a>
                    <a href="#modal_solicitar_cajas" data-toggle="modal" id="btn_requ_cajas">Boxes</a>
                </div>
            </div>

            <div class="dropdown">
                <button class="dropbtn">Locations</button>
                <div class="dropdown-content">
                    <a href="#modal_new_location" data-toggle="modal" class="btn_agregar_locaciones">Add</a>
                    <a href="#modal_trim_location_state" data-toggle="modal" class="btn_location_state">Report</a>
                </div>
            </div>

            <div class="dropdown">
                <button class="dropbtn">Delivery</button>
                <div class="dropdown-content">
                    <a href="#modal_formulario_entrega" data-toggle="modal" class="btn_entregar_material">New delivery</a>
                    <a href="#modal_listado_entregas" data-toggle="modal" class="btn_listado_entregas">Deliveries history</a>
                </div>
            </div>

            <div class="dropdown">
                <button class="dropbtn">Price tickets</button>
                <div class="dropdown-content">
                    <a href="#modal_comparar_excel" data-toggle="modal" class="btn_subir_archivo">Add price tickets</a>
                    <a href="#modal_buscar_pt" data-toggle="modal" class="btn_buscar_pt">Search price tickets</a>
                    <a href="#modal_ver_pt" data-toggle="modal" class="btn_ver_pt">Orders price tickets</a>
                </div>
            </div>

            <div class="dropdown">
                <a href="@Url.Action("packing_instruction","Trims")">
                    <button class="dropbtn" type="button" id="boton_trims">Trim card</button>
                </a>
            </div>

            <div class="dropdown">
                <button class="dropbtn">Stock</button>
                <div class="dropdown-content">
                    <a href="#modal_lista_inventario_trim" data-toggle="modal" class="btn_list_trim">List</a>
                    <a href="#modal_reporte_stock_cliente" data-toggle="modal" class="btn_report_customer">Customer report</a>
                </div>
            </div>


        </div>
    </div>

    <div class="row" style="height:250px;">
        <div style=" width: 45%; float:left; ">


            <div class="panel" style=" height:250px; width:98%; margin-left:2em; overflow:auto; margin-right:1em;border: 1px solid #3479bf; ">
                <div class="panel-heading"><label class=" col-form-label">Prim guide</label></div>
                <table id="tabla_trims_inicio" class="table table-striped " style=" ">
                    <thead class="cabecera_tabla_trims_inicio cabecera_tabla"><tr><th>AMT</th><th>Description</th><th>Minimum</th><th>Stock</th></thead>
                    <tbody class="body_tabla_trims_inicio"></tbody>
                </table>
            </div>
        </div>

        <div class="panel" style="float:right; width: 50%; height:250px; overflow:auto; margin-right:2em;border: 1px solid #3479bf; ">
            <div class="panel-heading"><label class=" col-form-label">To order</label></div>
            <table id="tabla_trims_inicio" class="table table-striped " style=" ">
                <thead class="cabecera_tabla_trims_inicio cabecera_tabla"><tr><th>AMT</th><th>Description</th><th>Minimum</th><th>Stock</th></thead>
                <tbody class="body_tabla_trims_inicio"></tbody>
            </table>
        </div>
    </div>

    <div class="row" style="height:300px; width:100%; margin-left: 1em;">
        <div class="panel" style="float:left; width: 45%; height:295px;  border: 1px solid #3479bf;">
            <div class="panel-heading" style="height:3.2em;">
                <label style="float:left;" class=" col-form-label">Trim status by order</label>
                <input style="float:right;" type="text" ondrop="return false;" onpaste="return false;" class="form-control validacion " maxlength="30" onkeyup="busqueda_estado_pedido(event)" id="caja_busqueda_estado_pedido">
            </div>
            <div style="height: 40px; color:white; background:#3479bf;">
                <label class=" col-form-label" style="padding-left:1em;">By dates</label>
                <input type="text" autocomplete="false" style="float:right; width:20%; margin-right:1em;" placeholder="TO" class="form-control must_trans_edit  " ondrop="return false;" onpaste="return false;" onchange="excel_estados_pedidos_trim()" maxlength="10" id="caja_estado_final">
                <input style="float:right; width:20%; margin-right:3em;" autocomplete="false" type="text" placeholder="FROM" ondrop="return false;" onpaste="return false;" class="form-control validacion " onchange="excel_estados_pedidos_trim()" maxlength="10" id="caja_estado_inicio">

            </div>
            <table id="" class="table table-striped " style=" ">
                <thead class="cabecera_tabla_ordenes_inicio cabecera_tabla">
                    <tr><th style="width:20%;">#</th><th style="width:20%;">Order</th><th style="width:20%;">Total</th><th style="width:20%;">Total received</th><th style="width:20%;">Status</th>
                </thead>
            </table>
            <div style="height:165px; overflow:auto;">
                <table id="tabla_ordenes_inicio" class="table table-striped " style=" ">
                    <tbody class="body_tabla_ordenes_inicio"></tbody>
                </table>
            </div>
        </div>

        <div class="panel" style="float:right; width: 52%;height:295px; overflow:auto; border: 1px solid #3479bf; margin-right: 1em;">
            <div class="panel-heading">
                <label class=" col-form-label">Trim</label>
                <input type="text" style="float:right; width:15%;" placeholder="DATE" class="form-control must_trans_edit  " ondrop="return false;" onpaste="return false;" onchange="llenar_tabla_trim_recibido_inicio()" id="caja_busqueda_fecha_trim_recibo">
                <input style="float:right; width:20%; margin-right:1em;" type="text" placeholder="SEARCH" ondrop="return false;" onpaste="return false;" class="form-control validacion " maxlength="30" onkeyup="llenar_tabla_trim_recibido_inicio()" id="caja_busqueda_trim_recibido">
            </div>
            <div style="padding:0px; margin:0px; color:white; background:#3479bf; text-align:center;">
                <label id="mp_numbers_label" class=" col-form-label"></label>
            </div>
            <table id="tabla_trim_recibido" class="table table-striped " style=" ">
                <thead class="cabecera_tabla_trim_recibido cabecera_tabla"><tr><th>#</th><th>Order</th><th>Style</th><th>Item</th><th>Date</th><th>Total</th><th>Audited</th></thead>
                <tbody class="body_tabla_trim_recibido"></tbody>
            </table>
        </div>

    </div>

</div>

<div class="modal fade" id="modal_reporte_stock_cliente" data-target="#modal_reporte_stock_cliente">
    <div class="modal-dialog modal-lg" style=" ">
        <div class="modal-content" style="  ">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Stock report</h4>
            </div>            
            <div class="modal-body " id="">
                <div id="" class=" " style=" ">
                    <div class="row" id="" style="padding:1em; ">
                        <div class="form-group col-sm-5 ">
                            <label for="caja_pedido_request">Customer </label>
                            <select class="form-control  customer_reporte_stock " style="width:100%;  " id="caja_customer_stock_reporte"></select>
                        </div>
                    </div>
                    <button type="button" style="margin-left:2em; " class="btn btn btn-warning" onclick="reporte_stock_cliente(event)" data-toggle="modal">Report</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_lista_existencia" data-target="#modal_lista_existencia">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Trims</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">
                <h3 id="po_orden_existencia"></h3>
                <div class="row panel" id=" " style="height:450px; padding:0em 2em 0em 2em;margin-top:1em;">
                    <div style=" ">
                        <table id="" class="table table-striped " style="margin:0px; ">
                            <thead class="cabecera_tabla">
                                <tr>
                                    <th style="width:40%;">Item</th>
                                    <th style="width:20%;">Existence</th>
                                    <th style="width:20%">Order</th>
                                    <th style="width:20%;">Need</th>
                                </tr>
                            </thead>
                        </table>
                        <div style="margin:0px; height:400px; overflow:auto; border: 2px solid #3479bf; border-top:none; border-radius: 5px; ">
                            <table id="tabla_diferencia_pedido_existencia" class="table table-striped ">
                                <tbody class="body_tabla_diferencia_pedido_existencia"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
         


            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_lista_inventario_trim" data-target="#modal_lista_inventario_trim">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_material_request" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Trims</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">


                <div class="row" id="" style=" padding:0em 2em 0em 2em; ">
                    <div class="form-group">
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Search </label>
                            <input type="text" class=" form-control validacion " onkeyup="buscar_inventario_tabla_trims(event)" ondrop="return false;" onpaste="return false;" maxlength="30" id="caja_busqueda_trim_inventario">
                        </div>
                    </div>
                </div>
                <div class="row panel" id=" " style="height:450px; padding:0em 2em 0em 2em;margin-top:1em;">
                    <div style=" ">
                        <table id="" class="table table-striped " style="margin:0px; ">
                            <thead class="cabecera_tabla">
                                <tr>
                                    <th style="width:5%;">#</th>
                                    <th style="width:20%;">Description</th>
                                    <th style="width:10%;">Total</th>
                                    <th style="width:15%">Order</th>
                                    <th style="width:20%;">Style</th>
                                    <th style="width:10%;">Family</th>
                                    <th style="width:10%;">Customer</th>
                                    <th style="width:10%;"></th>
                                </tr>
                            </thead>
                        </table>
                        <div style="margin:0px; height:400px; overflow:auto; border: 2px solid #3479bf; border-top:none; border-radius: 5px; ">
                            <table id="tabla_trims_lista_inventario" class="table table-striped ">
                                <tbody class="body_tabla_trims_lista_inventario"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row" id="div_cambiar_inventario" style=" padding:0em 2em 0em 2em; visibility:hidden; ">
                    <h3 id="letrero_cambio" style="">
                        Items change  <button type="button" class="btn btn-danger mb-2" id="boton_cerrar_cambio" onclick="cerrar_div_cambio_inventario()" style="">X</button>
                    </h3>
                    <div class="form-group">
                        <div class="form-group col-sm-1 ">
                            <label class=" col-form-label">Id</label>
                            <input readonly type="text" class=" form-control validacion " id="caja_id_inventario_trim">
                        </div>
                        <div class="form-group col-sm-3 ">
                            <label class=" col-form-label">Item</label>
                            <input readonly type="text" style="width:200%;" class=" form-control validacion " ondrop="return false;" onpaste="return false;" maxlength="30" id="etiqueta_item_cambiar">
                        </div>
                        <div class="form-group col-sm-1 ">
                            <label class=" col-form-label">Quantity</label>
                            <input type="text" class=" form-control validacion " ondrop="return false;" onpaste="return false;" maxlength="30" id="caja_cantidad_cambio_trim_inventario">
                        </div>
                        <div id="div_pedido_inventario_trim" class="form-group col-sm-2 " style="visibility:hidden;">
                            <label for="caja_pedido_request">Order </label>
                            <select class="form-control js-example-basic-single pedidos_inventario_trims " style="width:100%;  " id="caja_pedido_inventario"></select>
                        </div>
                        <div class="form-group col-sm-3" id="div_estilos_inventario" style="visibility:hidden;"></div>                        
                        <div class="form-group col-sm-1">
                            <button type="button" class="btn btn-success mb-2" id="boton_intercambiar_inventario" onclick="cambiar_inventario_trims(event)" style=" margin-top:1.5em;  margin-right:2em;">Save</button>
                        </div>
                    </div>
                    <br />
                </div>


            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_recibos_trims" data-target="#modal_recibos_trims">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_material_request" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>New Receive</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">

                <div class="row" id="" style=" padding:0em 2em 0em 2em; ">
                    <div class="form-group">
                        <div class="form-group col-sm-2 ">
                            <label for="caja_pedido_request">Order </label>
                            <select class="form-control js-example-basic-single pedidos_recibo_trims " style="width:100%;  " id="caja_pedido_recibo"></select>
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">PO # </label>
                            <input type="text" class=" form-control validacion check_rec_trim" ondrop="return false;" onpaste="return false;" maxlength="30" id="caja_po_number_recibo">
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">MP </label>
                            <input type="text" class=" form-control validacion check_rec_trim" ondrop="return false;" onpaste="return false;" maxlength="30" id="caja_mp_recibo">
                        </div>

                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Packing number </label>
                            <input type="text" class=" form-control validacion check_rec_trim" ondrop="return false;" onpaste="return false;" maxlength="30" id="caja_packing_number_trim">
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Customer</label>
                            <select class="form-control  cliente_recibo_trims " style="width:100%;  " id="caja_cliente_recibo"></select>
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Branch</label>
                            <select class="form-control  cliente_sucursal_trims " style="width:100%;  " id="caja_sucursal_recibo"></select>
                        </div>
                    </div>
                </div>
                <div class="row panel" id="div_busqueda " style="height:250px; padding:0em 2em 0em 2em;margin-top:1em;">
                    <div class="panel-heading " tyle="padding-bottom: 1.5em;">
                        <label>Search trim</label>
                        <input style="float:right; " type="text" class=" form-control validacion " placeholder="SEARCH" ondrop="return false;" onpaste="return false;" onkeyup="llenar_tabla_items()" id="caja_busqueda_recibo_trims">
                    </div>

                    <div style=" ">
                        <table id="" class="table table-striped " style="margin:0px; ">
                            <thead class="cabecera_tabla"><tr><th style="width:6em;">#</th><th style="width:10em;">AMT</th><th style="width:20em;">Description</th><th style="width:6em;">Family</th></tr></thead>
                        </table>
                        <div style="margin:0px; height:170px; overflow:auto; border: 2px solid #3479bf; border-top:none; border-radius: 5px; ">
                            <table id="tabla_trims_recibos_temporal" class="table table-striped ">
                                <tbody class="body_tabla_trims_recibos_temporal"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row panel" id="div_tabla_trims_recibos" style="visibility:hidden; padding:2em; height:200px; border-radius: 5px;">
                    <h4>Items</h4>
                    <table id="" class="table table-striped " style="margin:0px; ">
                        <thead class="cabecera_tabla"><tr><th style="width:10%;">#</th><th style="width:15%;">AMT</th><th style="width:30%;">Trim</th><th style="width: 25%;">Style</th><th style="width:15%;">Quantity</th><th style="width:5%;"></th></tr></thead>
                    </table>
                    <div style="margin:0px; height:200px; overflow:auto; border: 2px solid #3479bf; border-top:none;">
                        <table id="tabla_trims_recibos" class="table table-striped ">
                            <tbody class="body_tabla_trims_recibos"></tbody>
                        </table>
                    </div>
                    <button type="button" class="btn btn-success mb-2" id="boton_guardar_recibo_trims" onclick="guardar_recibo_trims(event)" style=" margin-top:0.3em; float:right; margin-right:2em;">Save</button>
                </div>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_solicitar_cajas" data-target="#modal_solicitar_cajas">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_material_request" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Boxes request</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">

                <div class="row" style="">
                    <div class="form-group">
                        <div class="form-group col-md-2 ">
                            <label for="caja_pedido_request">Order </label>
                            <select class="form-control js-example-basic-single pedidos_boxes" style="width:100%;  " id="caja_pedido_boxes"></select>
                        </div>
                        <div class="form-group col-md-3" id="div_estilos_boxes" style="display:none;"></div>
                        <div class="form-group col-md-1" id="div_boton_estilos" style="margin-left:2em;">
                            <button type="button" class="btn btn-warning mb-2" onclick="ver_estilo()" id="boton_ver_estilo" style=" margin-top:1.7em;  float:right; margin-right:2em;">By styles</button>
                        </div>
                        <div class="form-group col-md-1" id="div_boton_pedido" style="">
                            <button type="button" class="btn btn-success mb-2" onclick="ver_cajas_orden()" id="boton_ver_todo" style=" margin-top:1.7em; float:right; margin-right:2em;">See all</button>
                        </div>
                    </div>
                </div>
                <div class="row" id="div_tabla_solicitud_cajas" style="display:none;">
                    <h4 style="border-bottom: solid 1px #3c763d;color: #3c763d; font-weight: bold; margin-top: 1em;">Select the boxes to order</h4>
                    <table id="tabla_solicitud_cajas" class="table table-striped ">
                        <thead><tr><th>#</th><th>Box</th><th>Order quantity</th><th>Total</th><th style="visibility:hidden;width:.5em;"></th><th style="visibility:hidden;width:.5em;"></th></tr></thead>
                        <tbody class="body_tabla_solicitud_cajas"></tbody>
                    </table>
                    <button type="button" class="btn btn-success mb-2" id="boton_guardar_boxes_request" onclick="guardar_boxes_request(event)" style="display:none; margin-top:0.3em; float:right; margin-right:2em;">Save</button>

                </div>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_ver_pt" data-target="#modal_ver_pt">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="">Orders price tickets</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">
                <h4 id=""><span class="glyphicon glyphicon-check" aria-hidden="true"></span> Mark price tickets as printed </h4>
                <div id="div_tabla_order_price_ticket" class="row" style=" padding: 1em; height:40em; overflow:auto;">

                    <table id="tabla_order_price_ticket" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_order_price_ticket" style="background:#3479bf; color:white;">
                            <tr><th style="width:15em;">Order</th><th style="width:10em;">Customer</th><th style="width:30em;">Style</th><th>Sizes</th></tr>
                        </thead>
                        <tbody class="rows_tabla_order_price_ticket"></tbody>
                    </table>

                </div>
                <button type="button" class="btn btn-warning" onclick="obtener_datos_pt(event)" id="btn_marcar_pt" style="visibility:hidden; float: right; margin: 1em; ">Save</button>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_buscar_pt" data-target="#modal_buscar_pt">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="">Search price tickets</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">

                <div id="div_buscar_p_t" class="form-group" style="">
                    <h4>Select order</h4>
                    <div class="form-group col-md-2 ">
                        <label for="caja_pedido_buscar_price_ticket">Order </label>
                        <select class="form-control js-example-basic-single pedidos_buscar_pt" style="width:100%;  " id="caja_pedido_buscar_price_ticket"></select>
                    </div>
                </div>
                <br />
                <div id="div_tabla_buscar_price_ticket" class="row" style="visibility:hidden; padding: 1em; ">
                    <h3 id="titulo_buscar_price_tickets"> </h3>
                    <table id="tabla_buscar_price_ticket" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_buscar_price_ticket" style="background:#3479bf; color:white;">
                            <tr>
                                <th>#</th>
                                <th>PO</th>
                                <th>Style</th>
                                <th>UPC</th>
                                <th>Description</th>
                                <th>Color</th>
                                <th>Size</th>
                                <th>Tickets</th>
                                <th>Dept</th>
                                <th>Class</th>
                                <th>Sub</th>
                                <th>Retail</th>
                                <th>Cl</th>
                                <th>Register date</th>
                                <th>User</th>
                            </tr>
                        </thead>
                        <tbody class="rows_tabla_buscar_price_ticket"></tbody>
                    </table>
                </div>


            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_comparar_excel" data-target="#modal_comparar_excel">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_comparacion_excel" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="">New price tickets</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">


                <div id="div_formulario_archivo" class="form-group" style="display:inline;">
                    <h3>Upload file </h3>
                    <div class="form-group col-md-2 ">
                        <label for="caja_pedido_subir_archivos">Order </label>
                        <select class="form-control js-example-basic-single pedidos_subir_archivos" style="width:100%;  " id="caja_pedido_subir_archivos"></select>
                    </div>
                    <div class="form-group col-md-2 ">
                        <input type="file" class="custom-file-input" id="FileUpload1" style=" float:left; margin-right:1em; padding-top:2em;" />
                    </div>
                    <div class="form-group col-md-2 ">
                        <br />
                        <!--<input type="button" class="btn btn-warning " id="btnUpload" value="Upload File" style="margin-top:1.5em;" />-->
                        <button type="button" class="btn btn-warning" id="btnUpload" style=" ">Upload</button>
                    </div>
                </div>

                <div id="div_tabla_price_ticket" class="row" style="visibility:hidden; padding: 1em; ">
                    <div>
                        <div style="float:left;">
                            <h3 id="titulo_pedido_price_tickets"> </h3>
                        </div>
                        <div style="float:left; padding-top:1.6em; margin-left:2em;">
                            <input type="checkbox" id="caja_impreso" /> <span class="checkboxtext"> &nbsp;&nbsp;Mark as printed </span>
                        </div>
                    </div>

                    <table id="tabla_price_ticket" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_price_ticket" style="background:#3479bf; color:white;">
                            <tr>
                                <th>#</th>
                                <th>State</th>
                                <th>PO</th>
                                <th>Style</th>
                                <th>UPC</th>
                                <th>Description</th>
                                <th>Color</th>
                                <th>Size</th>
                                <th>Tickets</th>
                                <th>Dept</th>
                                <th>Class</th>
                                <th>Sub</th>
                                <th>Reail</th>
                                <th>Cl</th>
                            </tr>
                        </thead>
                        <tbody class="rows_tabla_price_ticket"></tbody>
                    </table>
                    <div class="form-group">
                        <div class="form-group col-1">
                            <br />
                            <button type="button" class="btn btn-danger mb-2 " id="boton_back_pt" style=" float:right;margin-right:2em;">Return</button>
                        </div>
                        <div class="form-group col-1">
                            <br />
                            <button type="button" class="btn btn-success mb-2" id="boton_guardar_informacion" onclick="guardar_price_tickets(event)" style=" margin-top:0.3em;float:right;margin-right:2em;">Save</button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_trim_location_state" data-target="#modal_trim_location_state">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="">Trim locations</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">

                <div class="row" style="padding-left: 2em;">
                    <div class="form-group">
                        <div class="form-group col-md-2 ">
                            <label for="caja_pedido_local_state">Order </label>
                            <select class="form-control js-example-basic-single pedidos_local_state" style="width:100%;  " id="caja_pedido_local_state"></select>
                        </div>
                    </div>
                </div>

                <div id="div_resultados_trim_location" style="display:none;">
                    <h4 class="modal-title" id="titulo_locaciones_estado"></h4>
                    <table id="tabla_trim_location_state_po" class="fold-table table table-striped table-hover " style="margin:0px;">
                        <tr><td class="cabecera_tabla" style="border: none !important;">Customer</td><td style="border: none !important;"></td><td class="cabecera_tabla" style="border: none !important;">Ship date</td><td style="border: none !important;"></td></tr>
                        <tr><td class="cabecera_tabla" style="border: none !important;">Gender</td><td style="border: none !important;"></td></tr>
                    </table>
                    <table id="" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_trim_location_state_family" style="background:#3479bf; color:white;">
                            <tr>
                                <th style="width:15%;">Family</th>
                                <th style="width:14%;">Style</th>
                                <th style="width:5%;">Size</th>
                                <th style="width:15%;">Item</th>
                                <th style="width:5%;">Total Order</th>
                                <th style="width:5%;">Location</th>
                                <th style="width:18%;">Location details</th>
                                <th style="width:5%;">Delivered</th>
                                <th style="width:18%;">Delivery details</th>
                            </tr>
                        </thead>                        
                    </table>
                    <div style="height:460px; overflow:auto; border: 2px solid #3479bf; border-top: none; border-radius: 5px;">
                        <table id="tabla_trim_location_state_family" class="fold-table table table-striped table-hover " style="margin:0px;">
                            <tbody class="rows_tabla_trim_location_state_family"></tbody>
                        </table>
                    </div>                    
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_new_location" data-target="#modal_new_location">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_material_request" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Trim locations</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">

                <div class="row" style="padding-left: 2em;">
                    <div class="form-group">
                        <div class="form-group col-md-2 ">
                            <label for="caja_pedido_request">Order </label>
                            <select class="form-control js-example-basic-single pedidos_local" style="width:100%;  " id="caja_pedido_local"></select>
                        </div>
                        <div class="form-group col-sm-3 ">
                            <label for="caja_location" class=" col-form-label ">Location</label>
                            <input type="text" class="form-control order validacion" onkeydown="upperCaseF(this)" ondrop="return false;" onpaste="return false;" maxlength="6" id="caja_location">
                        </div>
                    </div>
                </div>
                <div id="div_tabla_trims_locations" class="row" style="visibility:hidden; padding-left: 2em;">
                    <table id="tabla_trims_locations" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_trims_locations" style="background:#3479bf; color:white;">
                            <tr><th>#</th><th>Style</th><th>Item</th><th>Order total</th><th>Remaining</th><th>Quantity</th><th style="visibility:hidden; width:1em;">CB</th></tr>
                        </thead>
                        <tbody class="rows_tabla_trims_locations"></tbody>
                    </table>
                    <div class="form-group col-1">
                        <br />
                        <button type="button" class="btn btn-success mb-2" id="boton_agregar_item_tabla" onclick="agregar_locaciones(event)" style=" margin-top:0.3em;float:right;margin-right:2em;">Save</button>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_trim_state" data-target="#modal_trim_state">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="titulo_colores"></h4>
            </div>
            <div class="modal-body " style="overflow:auto;">
                <table id="tabla_trim_state_po" class="fold-table table table-striped table-hover ">
                    <tr><td class="cabecera_tabla" style="border: none !important;">Customer</td><td style="border: none !important;"></td><td class="cabecera_tabla" style="border: none !important;">Ship date</td><td style="border: none !important;"></td></tr>
                    <tr><td class="cabecera_tabla" style="border: none !important;">Gender</td><td style="border: none !important;"></td><td class="cabecera_tabla" style="border: none !important;">Packing</td><td style="border: none !important;"></td></tr>
                </table>
                <table id="" class="fold-table table table-striped table-hover " style="margin:0px;">
                    <thead class="cabecera_tabla_trim_state_family" style="background:#3479bf; color:white;">
                        <tr>
                            <th style="width:21%;">Family</th>
                            <th style="width:20%;">Style</th>
                            <th style="width:5%;">Size</th>
                            <th style="width:20%;">Item</th>
                            <th style="width:5%;">Total</th>
                            <th style="width:5%;">Received</th>
                            <th style="width:8%;">MP Number</th>
                            <th style="width:8%;">Receive date</th>
                            <th style="width:8%;">Status</th>
                        </tr>
                    </thead>                    
                </table>
                <div style="margin:0px; height:450px; overflow:auto; border: solid 2px #3479bf; border-radius: 5px; border-top: none;">
                    <table id="tabla_trim_state_family" class="fold-table table table-striped table-hover ">
                        <tbody class="rows_tabla_trim_state_family"></tbody>
                    </table>
                </div>               

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_listado_entregas" data-target="#modal_listado_entregas">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Receives and details</h4>
            </div>

            <div class="modal-body " id="contenedor_modal_listado_recibos">
                <div class="row" style="padding:1em;">
                    <div class="form-group">
                        <div class="form-group col-md-2 ">
                            <label for="caja_pedido_busqueda_entrega">Order </label>
                            <select class="form-control js-example-basic-single pedido_busqueda_entrega " style="width:100%;  " id="caja_pedido_busqueda_entrega"></select>
                        </div>
                        <div class="form-group col-md-3" id="div_estilos_busqueda_entrega" style="display:none;"></div>

                        <div class="form-group col-sm-2 ">
                            <label for="caja_inicio" class=" col-form-label ">From </label>
                            <input type="text" class="form-control order " placeholder="SELECT DATE" onkeydown="upperCaseF(this)" ondrop="return false;" onpaste="return false;" maxlength="23" id="caja_inicio_entrega">
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label for="caja_final" class=" col-form-label ">To </label>
                            <input type="text" class="form-control order " placeholder="SELECT DATE" onkeydown="upperCaseF(this)" ondrop="return false;" onpaste="return false;" maxlength="23" id="caja_final_entrega">
                        </div>
                        <div class="form-group col-sm-2  ">
                            <br />
                            <button type="button" style="margin-top: 0.5em; " class="btn btn-sm btn-success" onclick="buscar_entregas_fechas(event)" data-toggle="modal">Search</button>
                        </div>
                    </div>
                </div>

                <table id="tabla_historial_entregas" class="fold-table table table-striped table-hover ">
                    <thead class="cabecera_tabla_historial_entregas" style="background:#3479bf; color:white;">
                        <tr><th>Date</th><th>Deliver</th><th>Receive</th><th>Order</th><th>Style</th><th>Item</th><th>Total order</th><th>Total delivered</th></tr>
                    </thead>
                    <tbody class="rows_tabla_historial_entregas"></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_formulario_entrega" data-target="#modal_formulario_entrega">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong>New delivery</strong></h4>
            </div>
            <div class="modal-body " style="overflow:auto; ">
                <div class="form-group">
                    <div class="form-group col-md-3 ">
                        <label for="caja_pedido_entrega">Order </label><br />
                        <select class="form-control js-example-basic-single pedidos_entrega " style="width:100%;" id="caja_pedido_entrega"></select>
                    </div>
                    <div class="form-group col-sm-3 ">
                        <label class=" col-form-label">Deliver: </label>
                        <input type="text" class=" form-control validacion entrega_item" ondrop="return false;" onpaste="return false;" maxlength="150" id="caja_nombre_entrega">
                    </div>
                    <div class="form-group col-sm-3  ">
                        <label class=" col-form-label">Receive: </label>
                        <input type="text" class=" form-control validacion entrega_item" ondrop="return false;" onpaste="return false;" maxlength="10" id="caja_nombre_recibe">
                    </div>
                </div>
                <table id="tabla_trims_entrega" class="fold-table table table-striped table-hover ">
                    <thead class="cabecera_tabla_trims_entrega" style="background:#3479bf; color:white;">
                        <tr>
                            <th>#</th>
                            <th>Style</th>
                            <th>Item</th>
                            <th>Total</th>
                            <th>Quantity for delivery </th>
                            <th style="visibility:hidden; width:1em;">CB</th>
                        </tr>
                    </thead>
                    <tbody class="rows_tabla_trims_entrega"></tbody>
                </table>
                <button type="button" class="btn btn-success mb-2" id="boton_guardar_entrega" onclick="guardar_entrega(event)" style="margin-top:0.3em; float:right; margin-right:2em;">Save</button>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_trim_receive_details" data-target="#modal_trim_receive_details">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong>Receive information</strong></h4>
            </div>
            <div class="modal-body " style="overflow:auto; font-size: 1.5em;">

                <table id="tabla_recibo_individual_trim" class="table table-striped results_recibos">
                    <thead style="" class="cabecera_tabla">
                        <tr><th>#</th><th>MP</th><th>Date</th><th>Items</th><th>Total</th><th>User</th><th>Office</th><th>Mill Po</th><th>PO Reference</th></tr>
                    </thead>
                    <tbody class="recibo_individual_trim"></tbody>
                </table>
                <table id="tabla_listado_items_recibo_trim" class="table table-striped results_recibos">
                    <thead style="" class="cabecera_tabla">
                        <tr><th>PO</th><th>Category</th><th>Description</th><th>Total</th></tr>
                    </thead>
                    <tbody class="recibo_items_individual_trim"></tbody>
                </table>



            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_comparacion" data-target="#modal_comparacion">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong>Comparison table</strong></h4>
            </div>
            <div class="modal-body " style="overflow:auto;">
                <div class="row" id="" style="">
                    <table id="tabla_comparacion_auditado" class="table table-striped ">
                        <thead><tr><th>Order</th><th>Style</th><th>Item</th><th>Type</th><th>Total order</th><th>Receive date</th><th>Total receive</th><th>Status</th></tr></thead>
                        <tbody class="body_tabla_comparacion_auditado"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_editar_item" data-target="#modal_editar_item">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong>Modify</strong></h4>
            </div>
            <input type="hidden" id="id_trim_edicion">

            <div class="row" style="margin:2em;">
                <div class="form-group col-sm-10">
                    <label for="caja_item_select" class=" col-form-label">Select </label>
                    <select class="form-control js-example-basic-single descripciones_edit " style="width:25em;" id="caja_item_select"></select>
                </div>
            </div>

            <div class="form-group" id="edicion_trim_catalogo" style="display:none;">
                <div class="form-group col-sm-4">
                    <label for="caja_trim_item" class=" col-form-label">Item</label>
                    <input type="text" ondrop="return false;" onpaste="return false;" class="form-control validacion  edit_trim " maxlength="30" onkeydown="upperCaseF(this)" id="caja_trim_item_edit">
                </div>
                <div class="form-group col-sm-4">
                    <label for="caja_descripcion" class=" col-form-label">Description</label>
                    <input type="text" ondrop="return false;" onpaste="return false;" class="form-control validacion  edit_trim " maxlength="200" onkeydown="upperCaseF(this)" id="caja_descripcion_edit">
                </div>
                <div class="form-group col-sm-4">
                    <label for="caja_family_trim" class=" col-form-label">Family trim</label>
                    <input type="text" ondrop="return false;" onpaste="return false;" class="form-control validacion  edit_trim " maxlength="50" onkeydown="upperCaseF(this)" id="caja_family_trim_edit">
                </div>
                <div class="form-group col-sm-4">
                    <label for="caja_unit_trim" class=" col-form-label">Unit</label>
                    <input type="text" ondrop="return false;" onpaste="return false;" class="form-control validacion  edit_trim " maxlength="50" onkeydown="upperCaseF(this)" id="caja_unit_trim_edit">
                </div>
                <div class="form-group col-sm-4">
                    <label for="caja_minimo_trim" class=" col-form-label">Minimum</label>
                    <input type="text" ondrop="return false;" onpaste="return false;" class="form-control numeric  edit_trim " maxlength="50" onkeydown="upperCaseF(this)" id="caja_minimo_trim_edit" value="0">
                </div>
                <div class="form-group col-sm-3">
                    <br />
                    <button type="button" class="btn btn-primary mb-2" id="boton_guardar_trim" onclick="guardar_edicion_trim(event);">Save</button>
                </div>
            </div>


        </div>
    </div>
</div>

<div class="modal fade" id="modal_auditoria" data-target="#modal_auditoria">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong>Audit</strong></h4>
            </div>

            <div class="row" style="padding:2em; overflow:auto;">
                <div class="col-md-6" id="div_recibo_audit" style="float:left;  height:700px;">
                    <h3 style="color: #3479bf; font-weight: bold;">Warehouse</h3>
                    <table id="tabla_items_recibidos" class="table table-striped ">
                        <thead class="cabecera_tabla"><tr><th>PO</th><th>Style</th><th>Trim</th><th>Total</th><th style="visibility:hidden;"></th></tr></thead>
                        <tbody class="body_tabla_items_recibidos"></tbody>
                    </table>
                </div>
                <div class="col-md-6" id="div_edicion_audit" style="visibility:hidden;float:left; height:700px;">
                    <h3 style="color: #3479bf; font-weight: bold;">Adjustment</h3>
                    <table id="tabla_items_recibidos_modificar" class="table table-striped ">
                        <thead class="cabecera_tabla"><tr><th></th><th>Item</th><th>Total</th><th>New total</th><th></th></tr></thead>
                        <tbody class="body_tabla_items_recibidos_modificar"></tbody>
                    </table>
                    <button type="button" class="btn btn-success mb-2" id="boton_guardar_auditoria" onclick="enviar_correcciones(event)" style="margin-top:0.3em; float:right;">Save</button>
                </div>
            </div>

        </div>
    </div>
</div>

<div class="modal fade" id="modal_request" data-target="#modal_request">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_material_request" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Material request</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">
                <div class="row" style="">
                    <div class="form-group">
                        <div class="form-group col-md-2 ">
                            <label for="caja_pedido_request">Order </label>
                            <select class="form-control js-example-basic-single pedidos_request " style="width:100%;  " id="caja_pedido_request"></select>
                        </div>
                        <div class="form-group col-md-3" id="div_estilos_request" style="display:none;"></div>
                        <div class="form-group col-md-2" id="div_tallas_request" style="display:none;"></div>
                        <div class="form-group col-md-3" id="div_item_request" style="visibility:hidden;">
                            <label for="caja_item_request">Item </label>
                            <select class="form-control js-example-basic-single items_request " style="width:100%; " id="caja_item_request"></select>
                        </div>
                        <div class="form-group col-1" id="div_button_add" style="visibility:hidden;">
                            <br />
                            <button type="button" class="btn btn-success mb-2" id="boton_agregar_item_tabla" onclick="agregar_item_tablas()" style="margin-top:0.3em;">Add</button>
                        </div>
                    </div>
                </div>
                <div class="row" id="div_tabla_trim_seleccionado" style="display:none;">
                    <div class="form-group">
                        <div class="form-group col-md-3">
                            <label for="caja_fold_size_tc">Fold size </label>
                            <input type="text" class="form-control validacion" style="width:100%; " id="caja_fold_size_trim" />
                        </div>
                        <div class="form-group col-md-3" style="padding-top: 0.60em;">
                            <br />
                            <input type="checkbox" id="caja_instruccion_empaque_cb" style="margin-left:1em;" /> <span class="checkboxtext"> &nbsp;&nbsp;Packing intruction arrived </span>
                        </div>
                    </div>

                    <h4 style="border-bottom: solid 1px #3c763d;color: #3c763d; font-weight: bold; margin-top: 5em;">Trims</h4>
                    <div style="height:200px; overflow:auto; ">
                        <table id="tabla_trim_seleccionado" class="table table-striped ">
                            <thead><tr><th>Style</th><th>Trim</th><th>Quantity</th><th>Blank</th><th>Total</th><th></th><th style="visibility:hidden;width:.5em;"></th><th style="visibility:hidden;width:.5em;"></th><th style="visibility:hidden;width:.5em;"></th><th style="visibility:hidden;width:.5em;"></th><th style="visibility:hidden;width:.5em;"></th></tr></thead>
                            <tbody class="body_tabla_trim_seleccionado"></tbody>
                        </table>
                    </div>
                </div>
                <div class="row" id="div_tabla_cajas_seleccionadas" style="display:none;">
                    <h4 style="border-bottom: solid 1px #3c763d; color: #3c763d; font-weight: bold;">Boxes</h4>
                    <div style="height:200px; overflow:auto;">
                        <table id="tabla_cajas_seleccionadas" class="table table-striped ">
                            <thead><tr><th>Style</th><th>Box</th><th>Quantity</th><th></th><th style="visibility:hidden; width:.5em;"></th><th style="visibility:hidden;width:.5em;"></th></tr></thead>
                            <tbody class="body_tabla_cajas_seleccionadas"></tbody>
                        </table>
                    </div>
                </div>
                <div class="row">
                    <button type="button" class="btn btn-success mb-2" id="boton_guardar_request" onclick="guardar_request(event)" style="display:none; margin-top:0.3em; float:right; margin-right:2em;">Save</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_listado_recibos" data-target="#modal_listado_recibos">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Receives and details</h4>
            </div>
            <div class="modal-body " id="contenedor_modal_listado_recibos">


                <div class="row" id="" style="padding:1em; ">
                    <div class="form-group col-sm-3 ">
                        <label for="caja_inicio" class=" col-form-label ">Search</label>
                        <input type="text" ondrop="return false;" onpaste="return false;" class="form-control validacion " maxlength="30" onkeyup="buscar_recibos_trims(event)" id="caja_busqueda_recibo_trim">

                    </div>
                    <div class="form-group col-sm-3 ">
                        <label for="caja_inicio" class=" col-form-label ">From this date</label>
                        <input type="text" class="form-control order " onkeydown="upperCaseF(this)" ondrop="return false;" onpaste="return false;" maxlength="23" id="caja_inicio">
                    </div>
                    <div class="form-group col-sm-3 ">
                        <label for="caja_final" class=" col-form-label ">To this date</label>
                        <input type="text" class="form-control order " onkeydown="upperCaseF(this)" ondrop="return false;" onpaste="return false;" maxlength="23" id="caja_final">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <br />
                        <button type="button" style="margin-top: 0.1em; " class="btn btn-sm btn-success" onclick="buscar_recibos_fechas(event)" data-toggle="modal">Search</button>
                    </div>
                </div>
                <div class="panel" style="border:2px solid #3479bf; max-height:500px; ">
                    <table id="" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_recibos_trim" style="background:#3479bf; color:white;">
                            <tr><th style="width:10%;">#</th><th style="width:15%;">DATE</th><th style="width:10%;">MP</th><th style="width:10%;">ORDER</th><th style="width:10%;">PO</th><th style="width:30%;">Items</th><th style="width:15%;">TOTAL</th></tr>
                        </thead>
                    </table>
                    <div style="overflow:auto; max-height: 450px;">
                        <table id="tabla_recibos_trim" class="fold-table table table-striped table-hover ">
                            <tbody class="rows_tabla_recibos_trim"></tbody>
                        </table>
                    </div>
                </div>


            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_formulario_nuevo_item" data-target="#modal_formulario_nuevo_item">
    <div class="modal-dialog">
        <div class="modal-content" style="overflow:auto;">
            <div class="modal-header orange modal-header-primary">
                <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>

                </button>
                <h4 class="modal-title"><strong></strong>New item</h4>

            </div>
            <div class="modal-body">
                @{
                    Html.RenderPartial("formulario_nuevo_item", "Almacen");
                }
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_recibir_transferencias" data-target="#modal_recibir_transferencias">
    <div class="modal-dialog">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange modal-header-primary">
                <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Receive transfer</h4>
            </div>
            <div class="modal-body">
                <div id="contenedor_modal_recibir_transferencia"></div>
                @{
                    //Html.RenderAction("edicion_inventario","Almacen");
                }
            </div>
        </div>
    </div>
</div>

<script>

    $(".btn_recibir_transferencia").click(function () {
        $("#contenedor_modal_recibir_transferencia").load("/Almacen/lista_recepcion_transferencias", function () {
            $("#modal_recibir_transferencias").modal("show");
        });
    });
</script>
